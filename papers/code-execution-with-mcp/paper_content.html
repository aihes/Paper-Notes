<!DOCTYPE html><html lang="en" class="__variable_bf5c26 __variable_afd42d __variable_5e9598 __variable_403256 __variable_57fc85 __variable_34e0db __variable_8bd1a6"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/42c6973fffeb4919-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/4e8887750eb14755-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/54e05bce7a25fe9c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/5dd0369324c6e67e-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/73af0ef16113246e-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/7b13d0d32c6ab893-s.p.ttf" as="font" crossorigin="" type="font/ttf"/><link rel="preload" href="/_next/static/media/844eb89fa4effbb2-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/afcde17c90040887-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/c1cf232a330ed002-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/cfe503504e29ad5d-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/d7440d3c533a1aec-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/db2277a4dc542e54-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/5eee40f2a0b97eb9.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/fc59b9cd13857e1d.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f7880afb4044f8af.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/4a02c7e02d6928b7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/7877fafacaca6dde.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/8849da4b05334af0.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/30b381ed69092e80.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/43d206cc3630ea39.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3f1ba4eb51c41cb2.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/1878d521d08e94c9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm" href="/_next/static/chunks/webpack-5bb29459ba8abb19.js"/><script src="/_next/static/chunks/fd9d1056-0b3d1e0b010ff572.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/7023-f8015d96972cd1bb.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/main-app-55bbd77d79f9187f.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/8616-254847c413581317.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/app/(site)/layout-7ed9f87d12f7be91.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/d8e9270f-d57a4faa183a21b3.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/cc3e2e0e-9a8a205950288c5c.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/d8f92815-58bfe84c979b4d69.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/20e9ecfc-2a45032f86ca4c33.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/ccd63cfe-be58d908b1d80a17.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/3204862b-324c96543028037a.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/8ace8c09-2ef1471301516487.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/13b76428-b914bed72c3f2a72.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/2229-7e72d866a0a8a599.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/6648-415518a411696dac.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/775-e6da966f74201223.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/9105-9030fdd63d5e6625.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/3114-bea39ae2e9708c19.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/6156-9756cb2c325ff724.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/1148-941d0675ebb66cd3.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/app/(site)/engineering/%5Bslug%5D/page-5cbcea31328c9354.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><script src="/_next/static/chunks/app/(site)/not-found-282af4a7e99a1ad4.js" async="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script><meta name="theme-color" content="#141413"/><title>Code execution with MCP: building more efficient AI agents \ Anthropic</title><meta name="description" content="Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%."/><meta name="msapplication-TileColor" content="141413"/><meta name="msapplication-config" content="/browserconfig.xml"/><meta property="og:title" content="Code execution with MCP: building more efficient AI agents"/><meta property="og:description" content="Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%."/><meta property="og:image" content="https://cdn.sanity.io/images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png"/><meta property="og:image:alt" content="Image for MCP and code execution blog post."/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@AnthropicAI"/><meta name="twitter:creator" content="@AnthropicAI"/><meta name="twitter:title" content="Code execution with MCP: building more efficient AI agents"/><meta name="twitter:description" content="Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%."/><meta name="twitter:image" content="https://cdn.sanity.io/images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png"/><meta name="twitter:image:alt" content="Image for MCP and code execution blog post."/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" href="/images/icons/favicon-32x32.png"/><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"/><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180"/><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="141413"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule="" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm"></script></head><body><header class="SiteHeader_header__JZwqp" data-theme="light"><div class="SiteHeader_skipLinks__FBJM_"><a href="#main-content" class="SiteHeader_skipLink__5cD_c">Skip to main content</a><a href="#footer" class="SiteHeader_skipLink__5cD_c">Skip to footer</a></div><div class="page-wrapper SiteHeader_root__4Xd52"><a href="/" aria-label="Home"><div class="SiteHeader_logoDesktop__QF_jY"><div class="LogoWordmark_logo-lottie__HlhID"></div></div><svg class="Icon_icon__UdTNj SiteHeader_logoMobile__4zcw_" width="32" height="32" viewBox="0 0 46 32"><path d="M32.73 0h-6.945L38.45 32h6.945L32.73 0ZM12.665 0 0 32h7.082l2.59-6.72h13.25l2.59 6.72h7.082L19.929 0h-7.264Zm-.702 19.337 4.334-11.246 4.334 11.246h-8.668Z" fill="#000000"></path></svg></a><div class="SiteHeader_contentWrapper__UUrBN"><nav class="SiteHeader_nav__fFHf4"><ul class="SiteHeader_navList__TC1Q_"><li class="detail-m SiteHeader_navItem__iLoj9"><a href="/research" class="SiteHeader_navText__fhzDU">Research</a></li><li class="detail-m SiteHeader_navItem__iLoj9"><a href="/economic-futures" class="SiteHeader_navText__fhzDU">Economic Futures</a></li><li class="detail-m SiteHeader_navItem__iLoj9" data-category="Commitments"><button class="SiteHeader_navText__fhzDU" aria-haspopup="menu" aria-expanded="false" aria-controls="nav-dropdown-Commitments"><span>Commitments</span><svg class="Icon_icon__UdTNj SiteHeader_caretIcon__0UHHw" width="12" height="6.13" viewBox="0 0 8 5"><path d="M7.3016 0.231808C7.44932 0.0678162 7.70306 0.0546398 7.86724 0.20212C8.03137 0.349888 8.04461 0.603568 7.89692 0.767766L4.29684 4.76791L4.23434 4.82417C4.16662 4.87328 4.08425 4.89995 3.99918 4.89995C3.88588 4.89989 3.77733 4.85213 3.70152 4.76791L0.10144 0.767766L0.0537825 0.702139C-0.040206 0.541753 -0.0124254 0.331356 0.131128 0.20212C0.274775 0.0728844 0.486972 0.0674593 0.636608 0.1779L0.696765 0.231808L3.99918 3.90148L7.3016 0.231808Z" fill="currentColor"></path></svg></button></li><li class="detail-m SiteHeader_navItem__iLoj9" data-category="Learn"><button class="SiteHeader_navText__fhzDU" aria-haspopup="menu" aria-expanded="false" aria-controls="nav-dropdown-Learn"><span>Learn</span><svg class="Icon_icon__UdTNj SiteHeader_caretIcon__0UHHw" width="12" height="6.13" viewBox="0 0 8 5"><path d="M7.3016 0.231808C7.44932 0.0678162 7.70306 0.0546398 7.86724 0.20212C8.03137 0.349888 8.04461 0.603568 7.89692 0.767766L4.29684 4.76791L4.23434 4.82417C4.16662 4.87328 4.08425 4.89995 3.99918 4.89995C3.88588 4.89989 3.77733 4.85213 3.70152 4.76791L0.10144 0.767766L0.0537825 0.702139C-0.040206 0.541753 -0.0124254 0.331356 0.131128 0.20212C0.274775 0.0728844 0.486972 0.0674593 0.636608 0.1779L0.696765 0.231808L3.99918 3.90148L7.3016 0.231808Z" fill="currentColor"></path></svg></button></li><li class="detail-m SiteHeader_navItem__iLoj9"><a href="/news" class="SiteHeader_navText__fhzDU">News</a></li></ul></nav><div class="SiteHeader_claudeCtaWrapper__S0VLd"><a href="https://claude.ai/" class="SiteHeader_claudeCtaButton__ZmTxG detail-m" target="_blank" rel="noopener noreferrer">Try Claude</a><div class="SiteHeader_claudeCtaDropdownTrigger__7gtuH"><svg class="Icon_icon__UdTNj SiteHeader_claudeCtaIcon__VDITj" width="12" height="6.13" viewBox="0 0 8 5"><path d="M7.3016 0.231808C7.44932 0.0678162 7.70306 0.0546398 7.86724 0.20212C8.03137 0.349888 8.04461 0.603568 7.89692 0.767766L4.29684 4.76791L4.23434 4.82417C4.16662 4.87328 4.08425 4.89995 3.99918 4.89995C3.88588 4.89989 3.77733 4.85213 3.70152 4.76791L0.10144 0.767766L0.0537825 0.702139C-0.040206 0.541753 -0.0124254 0.331356 0.131128 0.20212C0.274775 0.0728844 0.486972 0.0674593 0.636608 0.1779L0.696765 0.231808L3.99918 3.90148L7.3016 0.231808Z" fill="currentColor"></path></svg></div></div><button class="SiteHeader_mobileIcon__OK1HE" aria-label="Navigation menu"><svg class="Icon_icon__UdTNj" width="24" height="24" viewBox="0 0 40 40"><path d="M18.75 28C19.1641 28.0002 19.5 28.3359 19.5 28.75C19.4999 29.1641 19.164 29.4998 18.75 29.5H7.91699C7.50281 29.5 7.16705 29.1642 7.16699 28.75C7.16699 28.3358 7.50278 28 7.91699 28H18.75ZM32.084 19.25C32.4979 19.2504 32.834 19.586 32.834 20C32.8339 20.4139 32.4979 20.7496 32.084 20.75H7.91699C7.50281 20.75 7.16705 20.4142 7.16699 20C7.16699 19.5858 7.50278 19.25 7.91699 19.25H32.084ZM32.084 10.5C32.4979 10.5004 32.834 10.836 32.834 11.25C32.8339 11.6639 32.4979 11.9996 32.084 12H7.91699C7.50282 12 7.16706 11.6642 7.16699 11.25C7.16699 10.8358 7.50278 10.5 7.91699 10.5H32.084Z" fill="#141413"></path></svg></button></div></div></header><main id="main-content" class=""><section class="page-wrapper HeroEngineering_hero__MmK87" aria-label="Engineering Article Hero"><a class="detail-m bold HeroEngineering_hubLink__tSdcv" href="/engineering">Engineering at Anthropic</a><div class="HeroEngineering_content__3awDN"><div class="HeroEngineering_header__fl24a"><div class="HeroEngineering_heroImage__7BZXh"><img alt="" loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent" src="https://www-cdn.anthropic.com/images/4zrzovbb/website/42f40f6fae9ec2d7cf2e5a98908a16d0216b91be-1000x1000.svg"/></div><h1 class="display-sans-xl bold">Code execution with MCP: Building more efficient agents</h1></div><div class="HeroEngineering_metadata__6bMUi"><p class="detail-m HeroEngineering_date__OnXQl">Published <!-- -->Nov 04, 2025</p><p class="detail-xl HeroEngineering_summary__prg8C">Direct tool calls consume context for each definition and result. Agents scale better by writing code to call tools instead. Here&#x27;s how it works with MCP.</p></div></div></section><div class="page-wrapper"><article><div class=""><div class="Body_body__XEXq7"><p class="Body_reading-column__t7kGM paragraph-m post-text"><a href="https://modelcontextprotocol.io/">The Model Context Protocol (MCP)</a> is an open standard for connecting AI agents to external systems. Connecting agents to tools and data traditionally requires a custom integration for each pairing, creating fragmentation and duplicated effort that makes it difficult to scale truly connected systems. MCP provides a universal protocol—developers implement MCP once in their agent and it unlocks an entire ecosystem of integrations.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Since launching MCP in November 2024, adoption has been rapid: the community has built thousands of <a href="https://github.com/modelcontextprotocol/servers" target="_blank" rel="noopener noreferrer">MCP servers</a>, <a href="https://modelcontextprotocol.io/docs/sdk" target="_blank" rel="noopener noreferrer">SDKs</a> are available for all major programming languages, and the industry has adopted MCP as the de-facto standard for connecting agents to tools and data.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Today developers routinely build agents with access to hundreds or thousands of tools across dozens of MCP servers. However, as the number of connected tools grows, loading all tool definitions upfront and passing intermediate results through the context window slows down agents and increases costs.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">In this blog we&#x27;ll explore how code execution can enable agents to interact with MCP servers more efficiently, handling more tools while using fewer tokens.</p><h2 class="Body_reading-column__t7kGM display-sans-m post-heading" id="excessive-token-consumption-from-tools-makes-agents-less-efficient"><strong>Excessive token consumption from tools makes agents less efficient</strong></h2><p class="Body_reading-column__t7kGM paragraph-m post-text">As MCP usage scales, there are two common patterns that can increase agent cost and latency:</p><ol class="Body_reading-column__t7kGM paragraph-m post-text"><li>Tool definitions overload the context window;</li><li>Intermediate tool results consume additional tokens.</li></ol><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="1-tool-definitions-overload-the-context-window"><strong>1. Tool definitions overload the context window</strong></h3><p class="Body_reading-column__t7kGM paragraph-m post-text">Most MCP clients load all tool definitions upfront directly into context, exposing them to the model using a direct tool-calling syntax. These tool definitions might look like: </p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">gdrive.getDocument
     Description: Retrieves a document from Google Drive
     Parameters:
                documentId (required, string): The ID of the document to retrieve
                fields (optional, string): Specific fields to return
     Returns: Document object with title, body content, metadata, permissions, etc.</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">salesforce.updateRecord
    Description: Updates a record in Salesforce
    Parameters:
               objectType (required, string): Type of Salesforce object (Lead, Contact,      Account, etc.)
               recordId (required, string): The ID of the record to update
               data (required, object): Fields to update with their new values
     Returns: Updated record object with confirmation</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Tool descriptions occupy more context window space, increasing response time and costs. In cases where agents are connected to thousands of tools, they’ll need to process hundreds of thousands of tokens before reading a request.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="2-intermediate-tool-results-consume-additional-tokens"><strong>2. Intermediate tool results consume additional tokens</strong></h3><p class="Body_reading-column__t7kGM paragraph-m post-text">Most MCP clients allow models to directly call MCP tools. For example, you might ask your agent: &quot;Download my meeting transcript from Google Drive and attach it to the Salesforce lead.&quot;</p><p class="Body_reading-column__t7kGM paragraph-m post-text">The model will make calls like:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">TOOL CALL: gdrive.getDocument(documentId: &quot;abc123&quot;)
        → returns &quot;Discussed Q4 goals...\n[full transcript text]&quot;
           (loaded into model context)

TOOL CALL: salesforce.updateRecord(
			objectType: &quot;SalesMeeting&quot;,
			recordId: &quot;00Q5f000001abcXYZ&quot;,
  			data: { &quot;Notes&quot;: &quot;Discussed Q4 goals...\n[full transcript text written out]&quot; }
		)
		(model needs to write entire transcript into context again)</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Every intermediate result must pass through the model. In this example, the full call transcript flows through twice. For a 2-hour sales meeting, that could mean processing an additional 50,000 tokens. Even larger documents may exceed context window limits, breaking the workflow.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">With large documents or complex data structures, models may be more likely to make mistakes when copying data between tool calls.</p><div class="Body_media-column__xPzhg"><figure class="ImageWithCaption_e-imageWithCaption__8C2mY ImageWithCaption_inline-image__B15e_"><img alt="Image of how the MCP client works with the MCP server and LLM." loading="lazy" width="1920" height="1080" decoding="async" data-nimg="1" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F9ecf165020005c09a22a9472cee6309555485619-1920x1080.png&amp;w=1920&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F9ecf165020005c09a22a9472cee6309555485619-1920x1080.png&amp;w=3840&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F9ecf165020005c09a22a9472cee6309555485619-1920x1080.png&amp;w=3840&amp;q=75"/><figcaption class="text-caption">The MCP client loads tool definitions into the model&#x27;s context window and orchestrates a message loop where each tool call and result passes through the model between operations.</figcaption></figure></div><h2 class="Body_reading-column__t7kGM display-sans-m post-heading" id="code-execution-with-mcp-improves-context-efficiency"><strong>Code execution with MCP improves context efficiency</strong></h2><p class="Body_reading-column__t7kGM paragraph-m post-text">With code execution environments becoming more common for agents, a solution is to present MCP servers as code APIs rather than direct tool calls. The agent can then write code to interact with MCP servers. This approach addresses both challenges: agents can load only the tools they need and process data in the execution environment before passing results back to the model.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">There are a number of ways to do this. One approach is to generate a file tree of all available tools from connected MCP servers. Here&#x27;s an implementation using TypeScript:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">servers
├── google-drive
│   ├── getDocument.ts
│   ├── ... (other tools)
│   └── index.ts
├── salesforce
│   ├── updateRecord.ts
│   ├── ... (other tools)
│   └── index.ts
└── ... (other servers)</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Then each tool corresponds to a file, something like:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">// ./servers/google-drive/getDocument.ts
import { callMCPTool } from &quot;../../../client.js&quot;;

interface GetDocumentInput {
  documentId: string;
}

interface GetDocumentResponse {
  content: string;
}

/* Read a document from Google Drive */
export async function getDocument(input: GetDocumentInput): Promise&lt;GetDocumentResponse&gt; {
  return callMCPTool&lt;GetDocumentResponse&gt;(&#x27;google_drive__get_document&#x27;, input);
}
</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Our Google Drive to Salesforce example above becomes the code:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">// Read transcript from Google Docs and add to Salesforce prospect
import * as gdrive from &#x27;./servers/google-drive&#x27;;
import * as salesforce from &#x27;./servers/salesforce&#x27;;

const transcript = (await gdrive.getDocument({ documentId: &#x27;abc123&#x27; })).content;
await salesforce.updateRecord({
  objectType: &#x27;SalesMeeting&#x27;,
  recordId: &#x27;00Q5f000001abcXYZ&#x27;,
  data: { Notes: transcript }
});
</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">The agent discovers tools by exploring the filesystem: listing the <code class="InlineCodeBlock_code____19F">./servers/ </code>directory to find available servers (like <code class="InlineCodeBlock_code____19F">google-drive</code> and <code class="InlineCodeBlock_code____19F">salesforce</code>), then reading the specific tool files it needs (like <code class="InlineCodeBlock_code____19F">getDocument.ts</code> and <code class="InlineCodeBlock_code____19F">updateRecord.ts</code>) to understand each tool&#x27;s interface. This lets the agent load only the definitions it needs for the current task. This reduces the token usage from 150,000 tokens to 2,000 tokens—a time and cost saving of 98.7%<strong>.</strong></p><p class="Body_reading-column__t7kGM paragraph-m post-text">Cloudflare <a href="https://blog.cloudflare.com/code-mode/" target="_blank" rel="noopener noreferrer">published similar findings</a>, referring to code execution with MCP as “Code Mode.&quot; The core insight is the same: LLMs are adept at writing code and developers should take advantage of this strength to build agents that interact with MCP servers more efficiently.</p><h2 class="Body_reading-column__t7kGM display-sans-m post-heading" id="benefits-of-code-execution-with-mcp"><strong>Benefits of code execution with MCP</strong></h2><p class="Body_reading-column__t7kGM paragraph-m post-text">Code execution with MCP enables agents to use context more efficiently by loading tools on demand, filtering data before it reaches the model, and executing complex logic in a single step. There are also security and state management benefits to using this approach.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="progressive-disclosure">Progressive disclosure</h3><p class="Body_reading-column__t7kGM paragraph-m post-text">Models are great at navigating filesystems. Presenting tools as code on a filesystem allows models to read tool definitions on-demand, rather than reading them all up-front.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Alternatively, a <code class="InlineCodeBlock_code____19F">search_tools</code> tool can be added to the server to find relevant definitions. For example, when working with the hypothetical Salesforce server used above, the agent searches for &quot;salesforce&quot; and loads only those tools that it needs for the current task. Including a detail level parameter in the <code class="InlineCodeBlock_code____19F">search_tools</code> tool that allows the agent to select the level of detail required (such as name only, name and description, or the full definition with schemas) also helps the agent conserve context and find tools efficiently.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="context-efficient-tool-results">Context efficient tool results</h3><p class="Body_reading-column__t7kGM paragraph-m post-text">When working with large datasets, agents can filter and transform results in code before returning them. Consider fetching a 10,000-row spreadsheet:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">// Without code execution - all rows flow through context
TOOL CALL: gdrive.getSheet(sheetId: &#x27;abc123&#x27;)
        → returns 10,000 rows in context to filter manually

// With code execution - filter in the execution environment
const allRows = await gdrive.getSheet({ sheetId: &#x27;abc123&#x27; });
const pendingOrders = allRows.filter(row =&gt; 
  row[&quot;Status&quot;] === &#x27;pending&#x27;
);
console.log(`Found ${pendingOrders.length} pending orders`);
console.log(pendingOrders.slice(0, 5)); // Only log first 5 for review</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">The agent sees five rows instead of 10,000. Similar patterns work for aggregations, joins across multiple data sources, or extracting specific fields—all without bloating the context window.</p><h4 class="Body_reading-column__t7kGM display-sans-xs post-subsection" id="more-powerful-and-context-efficient-control-flow"><strong>More powerful and context-efficient control flow</strong></h4><p class="Body_reading-column__t7kGM paragraph-m post-text">Loops, conditionals, and error handling can be done with familiar code patterns rather than chaining individual tool calls. For example, if you need a deployment notification in Slack, the agent can write:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">let found = false;
while (!found) {
  const messages = await slack.getChannelHistory({ channel: &#x27;C123456&#x27; });
  found = messages.some(m =&gt; m.text.includes(&#x27;deployment complete&#x27;));
  if (!found) await new Promise(r =&gt; setTimeout(r, 5000));
}
console.log(&#x27;Deployment notification received&#x27;);</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">This approach is more efficient than alternating between MCP tool calls and sleep commands through the agent loop.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Additionally, being able to write out a conditional tree that gets executed also saves on “time to first token” latency: rather than having to wait for a model to evaluate an if-statement, the agent can let the code execution environment do this.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="privacy-preserving-operations">Privacy-preserving operations</h3><p class="Body_reading-column__t7kGM paragraph-m post-text">When agents use code execution with MCP, intermediate results stay in the execution environment by default. This way, the agent only sees what you explicitly log or return, meaning data you don’t wish to share with the model can flow through your workflow without ever entering the model&#x27;s context.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">For even more sensitive workloads, the agent harness can tokenize sensitive data automatically. For example, imagine you need to import customer contact details from a spreadsheet into Salesforce. The agent writes:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">const sheet = await gdrive.getSheet({ sheetId: &#x27;abc123&#x27; });
for (const row of sheet.rows) {
  await salesforce.updateRecord({
    objectType: &#x27;Lead&#x27;,
    recordId: row.salesforceId,
    data: { 
      Email: row.email,
      Phone: row.phone,
      Name: row.name
    }
  });
}
console.log(`Updated ${sheet.rows.length} leads`);</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">The MCP client intercepts the data and tokenizes PII before it reaches the model:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">// What the agent would see, if it logged the sheet.rows:
[
  { salesforceId: &#x27;00Q...&#x27;, email: &#x27;[EMAIL_1]&#x27;, phone: &#x27;[PHONE_1]&#x27;, name: &#x27;[NAME_1]&#x27; },
  { salesforceId: &#x27;00Q...&#x27;, email: &#x27;[EMAIL_2]&#x27;, phone: &#x27;[PHONE_2]&#x27;, name: &#x27;[NAME_2]&#x27; },
  ...
]</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Then, when the data is shared in another MCP tool call, it is untokenized via a lookup in the MCP client. The real email addresses, phone numbers, and names flow from Google Sheets to Salesforce, but never through the model. This prevents the agent from accidentally logging or processing sensitive data. You can also use this to define deterministic security rules, choosing where data can flow to and from.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="state-persistence-and-skills">State persistence and skills</h3><p class="Body_reading-column__t7kGM paragraph-m post-text">Code execution with filesystem access allows agents to maintain state across operations. Agents can write intermediate results to files, enabling them to resume work and track progress:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">const leads = await salesforce.query({ 
  query: &#x27;SELECT Id, Email FROM Lead LIMIT 1000&#x27; 
});
const csvData = leads.map(l =&gt; `${l.Id},${l.Email}`).join(&#x27;\n&#x27;);
await fs.writeFile(&#x27;./workspace/leads.csv&#x27;, csvData);

// Later execution picks up where it left off
const saved = await fs.readFile(&#x27;./workspace/leads.csv&#x27;, &#x27;utf-8&#x27;);</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">Agents can also persist their own code as reusable functions. Once an agent develops working code for a task, it can save that implementation for future use:</p><div class="Body_media-column__xPzhg"><div class="CodeBlock_codeBlock__fiNtf"><pre class="" style="--height:300px;--height-expanded:0px"><code class="plaintext">// In ./skills/save-sheet-as-csv.ts
import * as gdrive from &#x27;./servers/google-drive&#x27;;
export async function saveSheetAsCsv(sheetId: string) {
  const data = await gdrive.getSheet({ sheetId });
  const csv = data.map(row =&gt; row.join(&#x27;,&#x27;)).join(&#x27;\n&#x27;);
  await fs.writeFile(`./workspace/sheet-${sheetId}.csv`, csv);
  return `./workspace/sheet-${sheetId}.csv`;
}

// Later, in any agent execution:
import { saveSheetAsCsv } from &#x27;./skills/save-sheet-as-csv&#x27;;
const csvPath = await saveSheetAsCsv(&#x27;abc123&#x27;);</code></pre><div class="CodeBlock_controls__Mytcn"><button aria-label="Copy code"><svg class="Icon_icon__UdTNj" width="17" height="16" viewBox="0 0 16 17"><path d="M12.5 2.49991H10.2338C9.95281 2.18536 9.6086 1.9337 9.22367 1.76138C8.83873 1.58907 8.42174 1.5 8 1.5C7.57826 1.5 7.16127 1.58907 6.77633 1.76138C6.39139 1.9337 6.04719 2.18536 5.76625 2.49991H3.5C3.23478 2.49991 2.98043 2.60527 2.79289 2.7928C2.60536 2.98034 2.5 3.23469 2.5 3.49991V13.9999C2.5 14.2651 2.60536 14.5195 2.79289 14.707C2.98043 14.8946 3.23478 14.9999 3.5 14.9999H12.5C12.7652 14.9999 13.0196 14.8946 13.2071 14.707C13.3946 14.5195 13.5 14.2651 13.5 13.9999V3.49991C13.5 3.23469 13.3946 2.98034 13.2071 2.7928C13.0196 2.60527 12.7652 2.49991 12.5 2.49991ZM8 2.49991C8.53043 2.49991 9.03914 2.71062 9.41421 3.0857C9.78929 3.46077 10 3.96948 10 4.49991H6C6 3.96948 6.21071 3.46077 6.58579 3.0857C6.96086 2.71062 7.46957 2.49991 8 2.49991ZM12.5 13.9999H3.5V3.49991H5.17188C5.05814 3.82104 5.00001 4.15923 5 4.49991V4.99991C5 5.13252 5.05268 5.25969 5.14645 5.35346C5.24021 5.44723 5.36739 5.49991 5.5 5.49991H10.5C10.6326 5.49991 10.7598 5.44723 10.8536 5.35346C10.9473 5.25969 11 5.13252 11 4.99991V4.49991C11 4.15923 10.9419 3.82104 10.8281 3.49991H12.5V13.9999Z" fill="currentColor"></path></svg><span>Copy</span></button></div></div></div><p class="Body_reading-column__t7kGM paragraph-m post-text">This ties in closely to the concept of <a href="https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview">Skills</a>, folders of reusable instructions, scripts, and resources for models to improve performance on specialized tasks. Adding a SKILL.md file to these saved functions creates a structured skill that models can reference and use. Over time, this allows your agent to build a toolbox of higher-level capabilities, evolving the scaffolding that it needs to work most effectively.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Note that code execution introduces its own complexity. Running agent-generated code requires a secure execution environment with appropriate <a href="https://www.anthropic.com/engineering/claude-code-sandboxing">sandboxing</a>, resource limits, and monitoring. These infrastructure requirements add operational overhead and security considerations that direct tool calls avoid. The benefits of code execution—reduced token costs, lower latency, and improved tool composition—should be weighed against these implementation costs.</p><h2 class="Body_reading-column__t7kGM display-sans-m post-heading" id="summary"><strong>Summary</strong></h2><p class="Body_reading-column__t7kGM paragraph-m post-text">MCP provides a foundational protocol for agents to connect to many tools and systems. However, once too many servers are connected, tool definitions and results can consume excessive tokens, reducing agent efficiency.</p><p class="Body_reading-column__t7kGM paragraph-m post-text">Although many of the problems here feel novel—context management, tool composition, state persistence—they have known solutions from software engineering. Code execution applies these established patterns to agents, letting them use familiar programming constructs to interact with MCP servers more efficiently. If you implement this approach, we encourage you to share your findings with the <a href="https://modelcontextprotocol.io/community/communication">MCP community</a>.</p><h3 class="Body_reading-column__t7kGM display-sans-s post-section" id="acknowledgments-">Acknowledgments </h3><p class="Body_reading-column__t7kGM paragraph-m post-text"><em>This article was written by Adam Jones and Conor Kelly. Thanks to Jeremy Fox, Jerome Swannack, Stuart Ritchie, Molly Vorwerck, Matt Samuels, and Maggie Vo for feedback on drafts of this post.</em></p></div></div></article><div class="NewsletterEngineering_wrapper__rU1ZD"><div class="NewsletterEngineering_content__93QQL"><div class="NewsletterEngineering_textContent__kIg0g"><h2 class="display-sans-xs bold NewsletterEngineering_title__418H3">Get the developer newsletter</h2><div class="NewsletterEngineering_body__I_7Ws"><p class="paragraph-s tight">Product updates, how-tos, community spotlights, and more. Delivered monthly to your inbox.</p></div></div><div class="NewsletterEngineering_formContainer__dLQhU"><form class="NewsletterEngineering_emailForm__L8qn8"><div class="NewsletterEngineering_inputWrapper__oNQR2"><input type="email" placeholder="Enter your email" class="NewsletterEngineering_emailInput__ey64Y" required="" name="email" value=""/><button type="submit" class="NewsletterEngineering_submitButton__EVorB"><svg class="Icon_icon__UdTNj" width="20" height="20" viewBox="0 0 21 21"><path d="M4.14585 9.87492L14.4584 9.87492L9.60419 5.04158L10.5 4.14575L16.8542 10.4999L10.5 16.8541L9.60419 15.9583L14.4584 11.1249L4.14585 11.1249L4.14585 9.87492Z" fill="#ffffff"></path></svg></button></div><p class="detail-s">Please provide your email address if you’d like to receive our monthly developer newsletter. You can unsubscribe at any time.</p></form></div></div></div></div></main><footer id="footer" class="SiteFooter_root__VoI_L" role="contentinfo" aria-label="Site footer"><div class="page-wrapper SiteFooter_footer__05g7R"><div class="SiteFooter_logoWrapper__yRyxb"><a href="/" aria-label="Return to homepage"><svg class="Icon_icon__UdTNj" width="46" height="32" viewBox="0 0 46 32"><path d="M32.73 0h-6.945L38.45 32h6.945L32.73 0ZM12.665 0 0 32h7.082l2.59-6.72h13.25l2.59 6.72h7.082L19.929 0h-7.264Zm-.702 19.337 4.334-11.246 4.334 11.246h-8.668Z" fill="#faf9f5"></path></svg></a></div><nav class="SiteFooter_linksWrapper__V_xa9" aria-label="Footer navigation"><div class="SiteFooter_columnSection__UQ8bf"><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Products</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://claude.com/product/overview" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Claude</a></li><li><a href="https://claude.com/product/claude-code" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Claude Code</a></li><li><a href="https://claude.com/claude-and-slack" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Claude and Slack</a></li><li><a href="https://claude.com/claude-for-excel" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Claude in Excel</a></li><li><a href="https://claude.com/pricing/max" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Max plan</a></li><li><a href="https://claude.com/pricing/team" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Team plan</a></li><li><a href="https://claude.com/pricing/enterprise" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Enterprise plan</a></li><li><a href="https://claude.ai/download" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Download app</a></li><li><a href="https://claude.com/pricing" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Pricing</a></li><li><a href="https://claude.ai/" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Log in to Claude</a></li></ul></div><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Models</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://www.anthropic.com/claude/opus" class="SiteFooter_listItem__unS4r detail-m agate">Opus</a></li><li><a href="https://www.anthropic.com/claude/sonnet" class="SiteFooter_listItem__unS4r detail-m agate">Sonnet</a></li><li><a href="https://www.anthropic.com/claude/haiku" class="SiteFooter_listItem__unS4r detail-m agate">Haiku</a></li></ul></div></div><div class="SiteFooter_columnSection__UQ8bf"><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Solutions</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://claude.com/solutions/agents" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">AI agents</a></li><li><a href="https://claude.com/solutions/code-modernization" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Code modernization</a></li><li><a href="https://claude.com/solutions/coding" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Coding</a></li><li><a href="https://claude.com/solutions/customer-support" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Customer support</a></li><li><a href="https://claude.com/solutions/education" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Education</a></li><li><a href="https://claude.com/solutions/financial-services" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Financial services</a></li><li><a href="https://claude.com/solutions/government" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Government</a></li><li><a href="https://claude.com/solutions/life-sciences" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Life sciences</a></li></ul></div><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Claude Developer Platform</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://claude.com/platform/api" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Overview</a></li><li><a href="https://docs.claude.com/en/home" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Developer docs</a></li><li><a href="https://claude.com/pricing#api" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Pricing</a></li><li><a href="https://claude.com/partners/amazon-bedrock" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Amazon Bedrock</a></li><li><a href="https://claude.com/partners/google-cloud-vertex-ai" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Google Cloud’s Vertex AI</a></li><li><a href="http://console.anthropic.com/" class="SiteFooter_listItem__unS4r detail-m agate">Console login</a></li></ul></div></div><div class="SiteFooter_columnSection__UQ8bf"><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Learn</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://claude.com/blog" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Blog</a></li><li><a href="/learn" class="SiteFooter_listItem__unS4r detail-m agate">Courses</a></li><li><a href="https://claude.com/partners/mcp" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Connectors</a></li><li><a href="https://claude.com/customers" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Customer stories</a></li><li><a href="/engineering" class="SiteFooter_listItem__unS4r detail-m agate">Engineering at Anthropic</a></li><li><a href="/events" class="SiteFooter_listItem__unS4r detail-m agate">Events</a></li><li><a href="https://claude.com/partners/powered-by-claude" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Powered by Claude</a></li><li><a href="https://claude.com/partners/services" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Service partners</a></li><li><a href="https://claude.com/programs/startups" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Startups program</a></li></ul></div><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Company</h3><ul class="SiteFooter_list__jhKng"><li><a href="/company" class="SiteFooter_listItem__unS4r detail-m agate">Anthropic</a></li><li><a href="/careers" class="SiteFooter_listItem__unS4r detail-m agate">Careers</a></li><li><a href="/economic-index" class="SiteFooter_listItem__unS4r detail-m agate">Economic Futures</a></li><li><a href="/research" class="SiteFooter_listItem__unS4r detail-m agate">Research</a></li><li><a href="/news" class="SiteFooter_listItem__unS4r detail-m agate">News</a></li><li><a href="https://www.anthropic.com/news/announcing-our-updated-responsible-scaling-policy" class="SiteFooter_listItem__unS4r detail-m agate">Responsible Scaling Policy</a></li><li><a href="https://trust.anthropic.com/" class="SiteFooter_listItem__unS4r detail-m agate">Security and compliance</a></li><li><a href="/transparency" class="SiteFooter_listItem__unS4r detail-m agate">Transparency</a></li></ul></div></div><div class="SiteFooter_columnSection__UQ8bf"><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Help and security</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://www.anthropic.com/supported-countries" class="SiteFooter_listItem__unS4r detail-m agate">Availability</a></li><li><a href="https://status.anthropic.com/" class="SiteFooter_listItem__unS4r detail-m agate">Status</a></li><li><a href="https://support.claude.com/en/" class="SiteFooter_listItem__unS4r detail-m agate" target="_blank" rel="noopener noreferrer">Support center</a></li></ul></div><div class="SiteFooter_listSection__FH30K"><h3 class="detail-m bold">Terms and policies</h3><ul class="SiteFooter_list__jhKng"><li><a href="https://www.anthropic.com/legal/privacy" class="SiteFooter_listItem__unS4r detail-m agate">Privacy policy</a></li><li><a href="https://www.anthropic.com/responsible-disclosure-policy" class="SiteFooter_listItem__unS4r detail-m agate">Responsible disclosure policy</a></li><li><a href="https://www.anthropic.com/legal/commercial-terms" class="SiteFooter_listItem__unS4r detail-m agate">Terms of service: Commercial</a></li><li><a href="https://www.anthropic.com/legal/consumer-terms" class="SiteFooter_listItem__unS4r detail-m agate">Terms of service: Consumer</a></li><li><a href="https://www.anthropic.com/legal/aup" class="SiteFooter_listItem__unS4r detail-m agate">Usage policy</a></li></ul></div></div></nav><div class="SiteFooter_socialWrapper__Evatb"><small class="detail-m agate" role="contentinfo">© 2025 Anthropic PBC</small><ul class="SiteFooter_socialIcons__WztHk" role="navigation" aria-label="Social media links"><li><a href="https://www.linkedin.com/company/anthropicresearch" aria-label="Visit our LinkedIn page" target="_blank" rel="noopener noreferrer"><svg class="Icon_icon__UdTNj" width="24" height="24" viewBox="0 0 32 32"><path d="M25.8182 4H6.18182C4.97636 4 4 4.97636 4 6.18182V25.8182C4 27.0236 4.97636 28 6.18182 28H25.8182C27.0236 28 28 27.0236 28 25.8182V6.18182C28 4.97636 27.0236 4 25.8182 4ZM11.5862 23.6364H8.368V13.2815H11.5862V23.6364ZM9.94436 11.8011C8.90691 11.8011 8.068 10.96 8.068 9.92473C8.068 8.88945 8.908 8.04945 9.94436 8.04945C10.9785 8.04945 11.8196 8.89055 11.8196 9.92473C11.8196 10.96 10.9785 11.8011 9.94436 11.8011ZM23.6407 23.6364H20.4247V18.6007C20.4247 17.3996 20.4029 15.8549 18.7524 15.8549C17.0778 15.8549 16.8204 17.1629 16.8204 18.5135V23.6364H13.6044V13.2815H16.6916V14.6964H16.7353C17.1651 13.8825 18.2145 13.024 19.78 13.024C23.0385 13.024 23.6407 15.1687 23.6407 17.9571V23.6364Z" fill="#b0aea5"></path></svg></a></li><li><a href="https://x.com/AnthropicAI" aria-label="Visit our X (formerly Twitter) profile" target="_blank" rel="noopener noreferrer"><svg class="Icon_icon__UdTNj" width="24" height="24" viewBox="0 0 32 32"><path d="M28 28L18.6145 14.0124L18.6305 14.0255L27.0929 4H24.265L17.3713 12.16L11.8968 4H4.48021L13.2425 17.0593L13.2414 17.0582L4 28H6.82792L14.4921 18.9215L20.5834 28H28ZM10.7763 6.18182L23.9449 25.8182H21.7039L8.52468 6.18182H10.7763Z" fill="#b0aea5"></path></svg></a></li><li><a href="https://www.youtube.com/@anthropic-ai" aria-label="Visit our YouTube channel" target="_blank" rel="noopener noreferrer"><svg class="Icon_icon__UdTNj" width="24" height="24" viewBox="0 0 32 32"><path d="M29.2184 9.4375C28.9596 8.06299 27.7263 7.06201 26.2951 6.74951C24.1533 6.3125 20.1896 6 15.901 6C11.615 6 7.58782 6.3125 5.44354 6.74951C4.01486 7.06201 2.77905 7.99951 2.52021 9.4375C2.25884 11 2 13.1875 2 16C2 18.8125 2.25884 21 2.58365 22.5625C2.84502 23.937 4.0783 24.938 5.50698 25.2505C7.78068 25.6875 11.6784 26 15.967 26C20.2556 26 24.1533 25.6875 26.427 25.2505C27.8557 24.938 29.089 24.0005 29.3504 22.5625C29.6092 21 29.934 18.749 30 16C29.868 13.1875 29.5432 11 29.2184 9.4375ZM12.3941 20.375V11.625L20.319 16L12.3941 20.375Z" fill="#b0aea5"></path></svg></a></li></ul></div></div></footer><script src="/_next/static/chunks/webpack-5bb29459ba8abb19.js" nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm" async=""></script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"1:HL[\"/_next/static/media/0a03b2d3f2326303-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/177b7db6a26ff4c3-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/18f7e26d8fc3ca09-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/202112071e5d7466-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/media/2d21c5135ef46b39-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n6:HL[\"/_next/static/media/42c6973fffeb4919-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n7:HL[\"/_next/static/media/4e8887750eb14755-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n8:HL[\"/_next/static/media/54e05bce7a25fe9c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n9:HL[\"/_next/static/media/5dd0369324c6e67e-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\na:HL[\"/_next/static/media/73af0ef16113246e-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\nb:HL[\"/_next/static/media/7b13d0d32c6ab893-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\nc:HL[\"/_next/static/media/844eb89fa4effbb2-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\nd:HL[\"/_next/static/media/afcde17c90040887-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\ne:HL[\"/_next/static/media/c1cf232a330ed002-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\nf:HL[\"/_next/static/media/cfe503504e29ad5d-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n10:HL[\"/_next/static/media/d7440d3c533a1aec-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n11:HL[\"/_next/static/media/db2277a4dc542e54-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n12:HL[\"/_next/static/css/5eee40f2a0b97eb9.css\",\"style\"]\n13:HL[\"/_next/static/css/fc59b9cd13857e1d.css\",\"style\"]\n14:HL[\"/_next/static/css/f7880afb4044f8af.css\",\"style\"]\n15:HL[\"/_next/static/css/4a02c7e02d6928b7.css\",\"style\"]\n16:HL[\"/_next/static/css/7877fafacaca6dde.css\",\"style\"]\n17:HL[\"/_next/static/css/8849da4b05334af0.css\",\"style"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"\"]\n18:HL[\"/_next/static/css/30b381ed69092e80.css\",\"style\"]\n19:HL[\"/_next/static/css/43d206cc3630ea39.css\",\"style\"]\n1a:HL[\"/_next/static/css/3f1ba4eb51c41cb2.css\",\"style\"]\n1b:HL[\"/_next/static/css/1878d521d08e94c9.css\",\"style\"]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"1c:I[95751,[],\"\"]\n1f:I[39275,[],\"\"]\n21:I[61343,[],\"\"]\n22:I[42594,[\"8616\",\"static/chunks/8616-254847c413581317.js\",\"7457\",\"static/chunks/app/(site)/layout-7ed9f87d12f7be91.js\"],\"default\"]\n23:I[24778,[\"8616\",\"static/chunks/8616-254847c413581317.js\",\"7457\",\"static/chunks/app/(site)/layout-7ed9f87d12f7be91.js\"],\"default\"]\n27:I[76130,[],\"\"]\n20:[\"slug\",\"code-execution-with-mcp\",\"d\"]\n28:[]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"0:[\"$\",\"$L1c\",null,{\"buildId\":\"RpMF9KH16YjqL5kOPxw4m\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"engineering\",\"code-execution-with-mcp\"],\"initialTree\":[\"\",{\"children\":[\"(site)\",{\"children\":[\"engineering\",{\"children\":[[\"slug\",\"code-execution-with-mcp\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(site)\",{\"children\":[\"engineering\",{\"children\":[[\"slug\",\"code-execution-with-mcp\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L1d\",\"$L1e\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f7880afb4044f8af.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4a02c7e02d6928b7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7877fafacaca6dde.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8849da4b05334af0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"4\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/30b381ed69092e80.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"5\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/43d206cc3630ea39.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"6\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3f1ba4eb51c41cb2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"7\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1878d521d08e94c9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L1f\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(site)\",\"children\",\"engineering\",\"children\",\"$20\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L21\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L1f\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(site)\",\"children\",\"engineering\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L21\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fc59b9cd13857e1d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L22\",null,{\"nonce\":\"MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm\",\"children\":[[\"$\",\"$L23\",null,{}],[\"$\",\"$L1f\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(site)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L21\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$L24\",\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f7880afb4044f8af.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4a02c7e02d6928b7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7877fafacaca6dde.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1878d521d08e94c9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}]]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5eee40f2a0b97eb9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],\"$L25\"],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L26\"],\"globalErrorComponent\":\"$27\",\"missingSlots\":\"$W28\"}]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"29:I[5778,[\"6744\",\"static/chunks/d8e9270f-d57a4faa183a21b3.js\",\"5055\",\"static/chunks/cc3e2e0e-9a8a205950288c5c.js\",\"9573\",\"static/chunks/d8f92815-58bfe84c979b4d69.js\",\"1440\",\"static/chunks/20e9ecfc-2a45032f86ca4c33.js\",\"8815\",\"static/chunks/ccd63cfe-be58d908b1d80a17.js\",\"2331\",\"static/chunks/3204862b-324c96543028037a.js\",\"6583\",\"static/chunks/8ace8c09-2ef1471301516487.js\",\"6990\",\"static/chunks/13b76428-b914bed72c3f2a72.js\",\"8616\",\"static/chunks/8616-254847c413581317.js\",\"2229\",\"static/chunks/2229-7e72d866a0a8a599.js\",\"6648\",\"static/chunks/6648-415518a411696dac.js\",\"775\",\"static/chunks/775-e6da966f74201223.js\",\"9105\",\"static/chunks/9105-9030fdd63d5e6625.js\",\"3114\",\"static/chunks/3114-bea39ae2e9708c19.js\",\"6156\",\"static/chunks/6156-9756cb2c325ff724.js\",\"1148\",\"static/chunks/1148-941d0675ebb66cd3.js\",\"8129\",\"static/chunks/app/(site)/engineering/%5Bslug%5D/page-5cbcea31328c9354.js\"],\"default\"]\n2a:I[36156,[\"6744\",\"static/chunks/d8e9270f-d57a4faa183a21b3.js\",\"5055\",\"static/chunks/cc3e2e0e-9a8a205950288c5c.js\",\"9573\",\"static/chunks/d8f92815-58bfe84c979b4d69.js\",\"1440\",\"static/chunks/20e9ecfc-2a45032f86ca4c33.js\",\"8815\",\"static/chunks/ccd63cfe-be58d908b1d80a17.js\",\"2331\",\"static/chunks/3204862b-324c96543028037a.js\",\"6583\",\"static/chunks/8ace8c09-2ef1471301516487.js\",\"6990\",\"static/chunks/13b76428-b914bed72c3f2a72.js\",\"8616\",\"static/chunks/8616-254847c413581317.js\",\"2229\",\"static/chunks/2229-7e72d866a0a8a599.js\",\"775\",\"static/chunks/775-e6da966f74201223.js\",\"3114\",\"static/chunks/3114-bea39ae2e9708c19.js\",\"6156\",\"static/chunks/6156-9756cb2c325ff724.js\",\"7995\",\"static/chunks/app/(site)/not-found-282af4a7e99a1ad4.js\"],\"default\"]\n2b:I[34231,[\"6744\",\"static/chunks/d8e9270f-d57a4faa183a21b3.js\",\"5055\",\"static/chunks/cc3e2e0e-9a8a205950288c5c.js\",\"9573\",\"static/chunks/d8f92815-58bfe84c979b4d69.js\",\"1440\",\"static/chunks/20e9ecfc-2a45032f86ca4c33.js\",\"8815\",\"static/chunks/ccd63cfe-be58d908b1d80a17.js\",\"2331\",\"static/chunks/3204862b-324c96543028037a.js\",\"6583\",\"static/chunks/8ace8c09-2ef1471301516487.js\",\"6990\",\"static/chunks/13b76"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"428-b914bed72c3f2a72.js\",\"8616\",\"static/chunks/8616-254847c413581317.js\",\"2229\",\"static/chunks/2229-7e72d866a0a8a599.js\",\"775\",\"static/chunks/775-e6da966f74201223.js\",\"3114\",\"static/chunks/3114-bea39ae2e9708c19.js\",\"6156\",\"static/chunks/6156-9756cb2c325ff724.js\",\"7995\",\"static/chunks/app/(site)/not-found-282af4a7e99a1ad4.js\"],\"default\"]\n25:[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_bf5c26 __variable_afd42d __variable_5e9598 __variable_403256 __variable_57fc85 __variable_34e0db __variable_8bd1a6\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L1f\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L21\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]}]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"1e:[\"$\",\"$L29\",null,{\"article\":{\"_createdAt\":\"2025-10-30T17:35:11Z\",\"_id\":\"15da8878-5f83-4cc7-85cb-c1a3c5cea708\",\"_rev\":\"bwKPjmaYrsWzvRbquECbUH\",\"_system\":{\"base\":{\"id\":\"15da8878-5f83-4cc7-85cb-c1a3c5cea708\",\"rev\":\"bwKPjmaYrsWzvRbquECOD5\"}},\"_type\":\"engineeringArticle\",\"_updatedAt\":\"2025-11-04T22:06:04Z\",\"body\":[{\"_key\":\"296bd09ab8b8\",\"_type\":\"block\",\"children\":[{\"_key\":\"aa17c16e631a0\",\"_type\":\"span\",\"marks\":[\"0caad24dea28\"],\"text\":\"The Model Context Protocol (MCP)\"},{\"_key\":\"aa17c16e631a1\",\"_type\":\"span\",\"marks\":[],\"text\":\" is an open standard for connecting AI agents to external systems. Connecting agents to tools and data traditionally requires a custom integration for each pairing, creating fragmentation and duplicated effort that makes it difficult to scale truly connected systems. MCP provides a universal protocol—developers implement MCP once in their agent and it unlocks an entire ecosystem of integrations.\"}],\"markDefs\":[{\"_key\":\"0caad24dea28\",\"_type\":\"link\",\"href\":\"https://modelcontextprotocol.io/\"}],\"style\":\"normal\"},{\"_key\":\"5bbd0468f96d\",\"_type\":\"block\",\"children\":[{\"_key\":\"bfcbe3e89c48\",\"_type\":\"span\",\"marks\":[],\"text\":\"Since launching MCP in November 2024, adoption has been rapid: the community has built thousands of \"},{\"_key\":\"aa17c16e631a2\",\"_type\":\"span\",\"marks\":[\"6da9393713b1\"],\"text\":\"MCP servers\"},{\"_key\":\"aa17c16e631a3\",\"_type\":\"span\",\"marks\":[],\"text\":\", \"},{\"_key\":\"aa17c16e631a4\",\"_type\":\"span\",\"marks\":[\"bc6f29aa4396\"],\"text\":\"SDKs\"},{\"_key\":\"aa17c16e631a5\",\"_type\":\"span\",\"marks\":[],\"text\":\" are available for all major programming languages, and the industry has adopted MCP as the de-facto standard for connecting agents to tools and data.\"}],\"markDefs\":[{\"_key\":\"6da9393713b1\",\"_type\":\"link\",\"blank\":true,\"href\":\"https://github.com/modelcontextprotocol/servers\"},{\"_key\":\"bc6f29aa4396\",\"_type\":\"link\",\"blank\":true,\"href\":\"https://modelcontextprotocol.io/docs/sdk\"}],\"style\":\"normal\"},{\"_key\":\"f410ca046723\",\"_type\":\"block\",\"children\":[{\"_key\":\"d3ffe9c772be\",\"_type\":\"span\",\"marks\":[],\"text\":\"Today developers routinely build agents with access to hundreds or thousands of tools across dozens of MCP servers. However, as the number of connected tools grows, loading all tool definitions upfront and passing intermediate results through the context window slows down agents and increases costs.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"65f320b46865\",\"_type\":\"block\",\"children\":[{\"_key\":\"86eee14e9b790\",\"_type\":\"span\",\"marks\":[],\"text\":\"In this blog we'll explore how code execution can enable agents to interact with MCP servers more efficiently, handling more tools while using fewer tokens.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"35945b692fdd\",\"_type\":\"block\",\"children\":[{\"_key\":\"b6ae3882f7110\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"Excessive token consumption from tools makes agents less efficient\"}],\"markDefs\":[],\"style\":\"h2\"},{\"_key\":\"fc8216619afa\",\"_type\":\"block\",\"children\":[{\"_key\":\"40807b9f7f5c0\",\"_type\":\"span\",\"marks\":[],\"text\":\"As MCP usage scales, there are two common patterns that can increase agent cost and latency:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"92d56a043950\",\"_type\":\"block\",\"children\":[{\"_key\":\"89786d4648560\",\"_type\":\"span\",\"marks\":[],\"text\":\"Tool definitions overload the context window;\"}],\"level\":1,\"listItem\":\"number\",\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"2043437700c4\",\"_type\":\"block\",\"children\":[{\"_key\":\"c2defbc1ecb50\",\"_type\":\"span\",\"marks\":[],\"text\":\"Intermediate tool results consume additional tokens.\"}],\"level\":1,\"listItem\":\"number\",\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"99a1585e6e2c\",\"_type\":\"block\",\"children\":[{\"_key\":\"5b6e3ffb68fc0\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"1. Tool definitions overload the context window\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"047ea72a1900\",\"_type\":\"block\",\"children\":[{\"_key\":\"6188aa09a2990\",\"_type\":\"span\",\"marks\":[],\"text\":\"Most MCP clients load all tool definitions upfront directly into context, exposing them to the model using a direct tool-calling syntax. These tool definitions might look like: \"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"fa068621fc9a\",\"_type\":\"codeBlock\",\"code\":\"gdrive.getDocument\\n     Description: Retrieves a document from Google Drive\\n     Parameters:\\n                documentId (required, string): The ID of the document to retrieve\\n                fields (optional, string): Specific fields to return\\n     Returns: Document object with title, body content, metadata, permissions, etc.\",\"markDefs\":null},{\"_key\":\"c58d7bbd73d7\",\"_type\":\"codeBlock\",\"code\":\"salesforce.updateRecord\\n    Description: Updates a record in Salesforce\\n    Parameters:\\n               objectType (required, string): Type of Salesforce object (Lead, Contact,      Account, etc.)\\n               recordId (required, string): The ID of the record to update\\n               data (required, object): Fields to update with their new values\\n     Returns: Updated record object with confirmation\",\"markDefs\":null},{\"_key\":\"cf6d124ba3ff\",\"_type\":\"block\",\"children\":[{\"_key\":\"c4a7c41513de0\",\"_type\":\"span\",\"marks\":[],\"text\":\"Tool descriptions occupy more context window space, increasing response time and costs. In cases where agents are connected to thousands of tools, they’ll need to process hundreds of thousands of tokens before reading a request.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"0b9874de233c\",\"_type\":\"block\",\"children\":[{\"_key\":\"cbcf6f3251330\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"2. Intermediate tool results consume additional tokens\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"5b5d6eb5fd30\",\"_type\":\"block\",\"children\":[{\"_key\":\"2d2a0cd558e10\",\"_type\":\"span\",\"marks\":[],\"text\":\"Most MCP clients allow models to directly call MCP tools. For example, you might ask your agent: \\\"Download my meeting transcript from Google Drive and attach it to the Salesforce lead.\\\"\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"872d82d35c00\",\"_type\":\"block\",\"children\":[{\"_key\":\"d56d200f81ba0\",\"_type\":\"span\",\"marks\":[],\"text\":\"The model will make calls like:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"92971e10b747\",\"_type\":\"codeBlock\",\"code\":\"TOOL CALL: gdrive.getDocument(documentId: \\\"abc123\\\")\\n        → returns \\\"Discussed Q4 goals...\\\\n[full transcript text]\\\"\\n           (loaded into model context)\\n\\nTOOL CALL: salesforce.updateRecord(\\n\\t\\t\\tobjectType: \\\"SalesMeeting\\\",\\n\\t\\t\\trecordId: \\\"00Q5f000001abcXYZ\\\",\\n  \\t\\t\\tdata: { \\\"Notes\\\": \\\"Discussed Q4 goals...\\\\n[full transcript text written out]\\\" }\\n\\t\\t)\\n\\t\\t(model needs to write entire transcript into context again)\",\"markDefs\":null},{\"_key\":\"d651c8dea015\",\"_type\":\"block\",\"children\":[{\"_key\":\"681c068bdd740\",\"_type\":\"span\",\"marks\":[],\"text\":\"Every intermediate result must pass through the model. In this example, the full call transcript flows through twice. For a 2-hour sales meeting, that could mean processing an additional 50,000 tokens. Even larger documents may exceed context window limits, breaking the workflow.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"4a3b8b57ee66\",\"_type\":\"block\",\"children\":[{\"_key\":\"c5b931b061e30\",\"_type\":\"span\",\"marks\":[],\"text\":\"With large documents or complex data structures, models may be more likely to make mistakes when copying data between tool calls.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"ea1fc0e5abe5\",\"_type\":\"image\",\"asset\":{\"_ref\":\"image-9ecf165020005c09a22a9472cee6309555485619-1920x1080-png\",\"_type\":\"reference\"},\"caption\":[{\"_key\":\"387c256ce4c1\",\"_type\":\"block\",\"children\":[{\"_key\":\"cbe6a34943990\",\"_type\":\"span\",\"marks\":[],\"text\":\"The MCP client loads tool definitions into the model's context window and orchestrates a message loop where each tool call and result passes through the model between operations.\"}],\"markDefs\":[],\"style\":\"normal\"}],\"description\":\"Image of how the MCP client works with the MCP server and LLM.\",\"height\":1080,\"markDefs\":null,\"style\":\"inline\",\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/9ecf165020005c09a22a9472cee6309555485619-1920x1080.png\",\"width\":1920},{\"_key\":\"cebebe86d2a4\",\"_type\":\"block\",\"children\":[{\"_key\":\"f6a91eaa47f80\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"Code execution with MCP improves context efficiency\"}],\"markDefs\":[],\"style\":\"h2\"},{\"_key\":\"530beb59de00\",\"_type\":\"block\",\"children\":[{\"_key\":\"ce8edc2feb990\",\"_type\":\"span\",\"marks\":[],\"text\":\"With code execution environments becoming more common for agents, a solution is to present MCP servers as code APIs rather than direct tool calls. The agent can then write code to interact with MCP servers. This approach addresses both challenges: agents can load only the tools they need and process data in the execution environment before passing results back to the model.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"95f70b3143f1\",\"_type\":\"block\",\"children\":[{\"_key\":\"6901ffef73340\",\"_type\":\"span\",\"marks\":[],\"text\":\"There are a number of ways to do this. One approach is to generate a file tree of all available tools from connected MCP servers. Here's an implementation using TypeScript:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"d54fcffb4e3d\",\"_type\":\"codeBlock\",\"code\":\"servers\\n├── google-drive\\n│   ├── getDocument.ts\\n│   ├── ... (other tools)\\n│   └── index.ts\\n├── salesforce\\n│   ├── updateRecord.ts\\n│   ├── ... (other tools)\\n│   └── index.ts\\n└── ... (other servers)\",\"markDefs\":null},{\"_key\":\"143bcf7ca7c4\",\"_type\":\"block\",\"children\":[{\"_key\":\"0f2b008639010\",\"_type\":\"span\",\"marks\":[],\"text\":\"Then each tool corresponds to a file, something like:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"2ea38bb12ad3\",\"_type\":\"codeBlock\",\"code\":\"// ./servers/google-drive/getDocument.ts\\nimport { callMCPTool } from \\\"../../../client.js\\\";\\n\\ninterface GetDocumentInput {\\n  documentId: string;\\n}\\n\\ninterface GetDocumentResponse {\\n  content: string;\\n}\\n\\n/* Read a document from Google Drive */\\nexport async function getDocument(input: GetDocumentInput): Promise\u003cGetDocumentResponse\u003e {\\n  return callMCPTool\u003cGetDocumentResponse\u003e('google_drive__get_document', input);\\n}\\n\",\"markDefs\":null},{\"_key\":\"242920014262\",\"_type\":\"block\",\"children\":[{\"_key\":\"6ef56d414df40\",\"_type\":\"span\",\"marks\":[],\"text\":\"Our Google Drive to Salesforce example above becomes the code:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"288850099f8a\",\"_type\":\"codeBlock\",\"code\":\"// Read transcript from Google Docs and add to Salesforce prospect\\nimport * as gdrive from './servers/google-drive';\\nimport * as salesforce from './servers/salesforce';\\n\\nconst transcript = (await gdrive.getDocument({ documentId: 'abc123' })).content;\\nawait salesforce.updateRecord({\\n  objectType: 'SalesMeeting',\\n  recordId: '00Q5f000001abcXYZ',\\n  data: { Notes: transcript }\\n});\\n\",\"markDefs\":null},{\"_key\":\"d754760b99b8\",\"_type\":\"block\",\"children\":[{\"_key\":\"49d998731e100\",\"_type\":\"span\",\"marks\":[],\"text\":\"The agent discovers tools by exploring the filesystem: listing the \"},{\"_key\":\"d82b0f530d45\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"./servers/ \"},{\"_key\":\"03b2540e98e7\",\"_type\":\"span\",\"marks\":[],\"text\":\"directory to find available servers (like \"},{\"_key\":\"006126080543\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"google-drive\"},{\"_key\":\"d89d628f3b3b\",\"_type\":\"span\",\"marks\":[],\"text\":\" and \"},{\"_key\":\"fde7f350cd0f\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"salesforce\"},{\"_key\":\"4e29da93d7c9\",\"_type\":\"span\",\"marks\":[],\"text\":\"), then reading the specific tool files it needs (like \"},{\"_key\":\"94514096b82c\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"getDocument.ts\"},{\"_key\":\"9492a602e339\",\"_type\":\"span\",\"marks\":[],\"text\":\" and \"},{\"_key\":\"963a141eeb04\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"updateRecord.ts\"},{\"_key\":\"9d3bfacff58a\",\"_type\":\"span\",\"marks\":[],\"text\":\") to understand each tool's interface. This lets the agent load only the definitions it needs for the current task. This reduces the token usage from 150,000 tokens to 2,000 tokens—a time and cost saving of 98.7%\"},{\"_key\":\"49d998731e101\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\".\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"2c9c6ec07dc1\",\"_type\":\"block\",\"children\":[{\"_key\":\"359ad6d519520\",\"_type\":\"span\",\"marks\":[],\"text\":\"Cloudflare \"},{\"_key\":\"359ad6d519521\",\"_type\":\"span\",\"marks\":[\"14b2aba2f56f\"],\"text\":\"published similar findings\"},{\"_key\":\"359ad6d519522\",\"_type\":\"span\",\"marks\":[],\"text\":\", referring to code execution with MCP as “Code Mode.\\\" The core insight is the same: LLMs are adept at writing code and developers should take advantage of this strength to build agents that interact with MCP servers more efficiently.\"}],\"markDefs\":[{\"_key\":\"14b2aba2f56f\",\"_type\":\"link\",\"blank\":true,\"href\":\"https://blog.cloudflare.com/code-mode/\"}],\"style\":\"normal\"},{\"_key\":\"0db834218953\",\"_type\":\"block\",\"children\":[{\"_key\":\"ff3065c1ee410\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"Benefits of code execution with MCP\"}],\"markDefs\":[],\"style\":\"h2\"},{\"_key\":\"69536bcd6ea6\",\"_type\":\"block\",\"children\":[{\"_key\":\"f3e23647b0a20\",\"_type\":\"span\",\"marks\":[],\"text\":\"Code execution with MCP enables agents to use context more efficiently by loading tools on demand, filtering data before it reaches the model, and executing complex logic in a single step. There are also security and state management benefits to using this approach.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"2a8b2e9615c1\",\"_type\":\"block\",\"children\":[{\"_key\":\"4872cc77c7100\",\"_type\":\"span\",\"marks\":[],\"text\":\"Progressive disclosure\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"84ac4565a456\",\"_type\":\"block\",\"children\":[{\"_key\":\"671d538e65580\",\"_type\":\"span\",\"marks\":[],\"text\":\"Models are great at navigating filesystems. Presenting tools as code on a filesystem allows models to read tool definitions on-demand, rather than reading them all up-front.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"27e9f80a5b1d\",\"_type\":\"block\",\"children\":[{\"_key\":\"2982aee36ce60\",\"_type\":\"span\",\"marks\":[],\"text\":\"Alternatively, a \"},{\"_key\":\"67af7fbbf0d6\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"search_tools\"},{\"_key\":\"1e2983990b10\",\"_type\":\"span\",\"marks\":[],\"text\":\" tool can be added to the server to find relevant definitions. For example, when working with the hypothetical Salesforce server used above, the agent searches for \\\"salesforce\\\" and loads only those tools that it needs for the current task. Including a detail level parameter in the \"},{\"_key\":\"1d0ce47b4aa6\",\"_type\":\"span\",\"marks\":[\"code\"],\"text\":\"search_tools\"},{\"_key\":\"62c51d609101\",\"_type\":\"span\",\"marks\":[],\"text\":\" tool that allows the agent to select the level of detail required (such as name only, name and description, or the full definition with schemas) also helps the agent conserve context and find tools efficiently.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"b740e5c61589\",\"_type\":\"block\",\"children\":[{\"_key\":\"f1ebcb05ba4a0\",\"_type\":\"span\",\"marks\":[],\"text\":\"Context efficient tool results\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"b5334f0ef0ca\",\"_type\":\"block\",\"children\":[{\"_key\":\"bde75ce336160\",\"_type\":\"span\",\"marks\":[],\"text\":\"When working with large datasets, agents can filter and transform results in code before returning them. Consider fetching a 10,000-row spreadsheet:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"81029ea8307c\",\"_type\":\"codeBlock\",\"code\":\"// Without code execution - all rows flow through context\\nTOOL CALL: gdrive.getSheet(sheetId: 'abc123')\\n        → returns 10,000 rows in context to filter manually\\n\\n// With code execution - filter in the execution environment\\nconst allRows = await gdrive.getSheet({ sheetId: 'abc123' });\\nconst pendingOrders = allRows.filter(row =\u003e \\n  row[\\\"Status\\\"] === 'pending'\\n);\\nconsole.log(`Found ${pendingOrders.length} pending orders`);\\nconsole.log(pendingOrders.slice(0, 5)); // Only log first 5 for review\",\"markDefs\":null},{\"_key\":\"d129d9ea11a5\",\"_type\":\"block\",\"children\":[{\"_key\":\"410a640daafa0\",\"_type\":\"span\",\"marks\":[],\"text\":\"The agent sees five rows instead of 10,000. Similar patterns work for aggregations, joins across multiple data sources, or extracting specific fields—all without bloating the context window.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"820ebe628ae0\",\"_type\":\"block\",\"children\":[{\"_key\":\"c7d3ec7bbb540\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"More powerful and context-efficient control flow\"}],\"markDefs\":[],\"style\":\"h4\"},{\"_key\":\"b8876e2529a3\",\"_type\":\"block\",\"children\":[{\"_key\":\"2cf25ac856e00\",\"_type\":\"span\",\"marks\":[],\"text\":\"Loops, conditionals, and error handling can be done with familiar code patterns rather than chaining individual tool calls. For example, if you need a deployment notification in Slack, the agent can write:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"4e05b6414c22\",\"_type\":\"codeBlock\",\"code\":\"let found = false;\\nwhile (!found) {\\n  const messages = await slack.getChannelHistory({ channel: 'C123456' });\\n  found = messages.some(m =\u003e m.text.includes('deployment complete'));\\n  if (!found) await new Promise(r =\u003e setTimeout(r, 5000));\\n}\\nconsole.log('Deployment notification received');\",\"markDefs\":null},{\"_key\":\"31706d5371fb\",\"_type\":\"block\",\"children\":[{\"_key\":\"3af5feac4a4a0\",\"_type\":\"span\",\"marks\":[],\"text\":\"This approach is more efficient than alternating between MCP tool calls and sleep commands through the agent loop.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"f50215583790\",\"_type\":\"block\",\"children\":[{\"_key\":\"b5b3f9c4e3760\",\"_type\":\"span\",\"marks\":[],\"text\":\"Additionally, being able to write out a conditional tree that gets executed also saves on “time to first token” latency: rather than having to wait for a model to evaluate an if-statement, the agent can let the code execution environment do this.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"a2c86839127d\",\"_type\":\"block\",\"children\":[{\"_key\":\"d457bdf595660\",\"_type\":\"span\",\"marks\":[],\"text\":\"Privacy-preserving operations\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"56da803cdec6\",\"_type\":\"block\",\"children\":[{\"_key\":\"15158242a92b0\",\"_type\":\"span\",\"marks\":[],\"text\":\"When agents use code execution with MCP, intermediate results stay in the execution environment by default. This way, the agent only sees what you explicitly log or return, meaning data you don’t wish to share with the model can flow through your workflow without ever entering the model's context.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"317e320c3518\",\"_type\":\"block\",\"children\":[{\"_key\":\"52c93c6b36150\",\"_type\":\"span\",\"marks\":[],\"text\":\"For even more sensitive workloads, the agent harness can tokenize sensitive data automatically. For example, imagine you need to import customer contact details from a spreadsheet into Salesforce. The agent writes:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"093765060414\",\"_type\":\"codeBlock\",\"code\":\"const sheet = await gdrive.getSheet({ sheetId: 'abc123' });\\nfor (const row of sheet.rows) {\\n  await salesforce.updateRecord({\\n    objectType: 'Lead',\\n    recordId: row.salesforceId,\\n    data: { \\n      Email: row.email,\\n      Phone: row.phone,\\n      Name: row.name\\n    }\\n  });\\n}\\nconsole.log(`Updated ${sheet.rows.length} leads`);\",\"markDefs\":null},{\"_key\":\"6ab5bdccf819\",\"_type\":\"block\",\"children\":[{\"_key\":\"82d34aabc43a0\",\"_type\":\"span\",\"marks\":[],\"text\":\"The MCP client intercepts the data and tokenizes PII before it reaches the model:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"7eb4abb51e0b\",\"_type\":\"codeBlock\",\"code\":\"// What the agent would see, if it logged the sheet.rows:\\n[\\n  { salesforceId: '00Q...', email: '[EMAIL_1]', phone: '[PHONE_1]', name: '[NAME_1]' },\\n  { salesforceId: '00Q...', email: '[EMAIL_2]', phone: '[PHONE_2]', name: '[NAME_2]' },\\n  ...\\n]\",\"markDefs\":null},{\"_key\":\"9ef530633ecc\",\"_type\":\"block\",\"children\":[{\"_key\":\"03d4ca47052d0\",\"_type\":\"span\",\"marks\":[],\"text\":\"Then, when the data is shared in another MCP tool call, it is untokenized via a lookup in the MCP client. The real email addresses, phone numbers, and names flow from Google Sheets to Salesforce, but never through the model. This prevents the agent from accidentally logging or processing sensitive data. You can also use this to define deterministic security rules, choosing where data can flow to and from.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"052e909f82e6\",\"_type\":\"block\",\"children\":[{\"_key\":\"953a9c8044440\",\"_type\":\"span\",\"marks\":[],\"text\":\"State persistence and skills\"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"27637cb9331a\",\"_type\":\"block\",\"children\":[{\"_key\":\"387850f92f3f0\",\"_type\":\"span\",\"marks\":[],\"text\":\"Code execution with filesystem access allows agents to maintain state across operations. Agents can write intermediate results to files, enabling them to resume work and track progress:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"9697c6411445\",\"_type\":\"codeBlock\",\"code\":\"const leads = await salesforce.query({ \\n  query: 'SELECT Id, Email FROM Lead LIMIT 1000' \\n});\\nconst csvData = leads.map(l =\u003e `${l.Id},${l.Email}`).join('\\\\n');\\nawait fs.writeFile('./workspace/leads.csv', csvData);\\n\\n// Later execution picks up where it left off\\nconst saved = await fs.readFile('./workspace/leads.csv', 'utf-8');\",\"markDefs\":null},{\"_key\":\"b4e3487ce77f\",\"_type\":\"block\",\"children\":[{\"_key\":\"e2bbe00864690\",\"_type\":\"span\",\"marks\":[],\"text\":\"Agents can also persist their own code as reusable functions. Once an agent develops working code for a task, it can save that implementation for future use:\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"e4d7df66c85b\",\"_type\":\"codeBlock\",\"code\":\"// In ./skills/save-sheet-as-csv.ts\\nimport * as gdrive from './servers/google-drive';\\nexport async function saveSheetAsCsv(sheetId: string) {\\n  const data = await gdrive.getSheet({ sheetId });\\n  const csv = data.map(row =\u003e row.join(',')).join('\\\\n');\\n  await fs.writeFile(`./workspace/sheet-${sheetId}.csv`, csv);\\n  return `./workspace/sheet-${sheetId}.csv`;\\n}\\n\\n// Later, in any agent execution:\\nimport { saveSheetAsCsv } from './skills/save-sheet-as-csv';\\nconst csvPath = await saveSheetAsCsv('abc123');\",\"markDefs\":null},{\"_key\":\"0660b2e9ca0f\",\"_type\":\"block\",\"children\":[{\"_key\":\"b343d88ec1d40\",\"_type\":\"span\",\"marks\":[],\"text\":\"This ties in closely to the concept of \"},{\"_key\":\"b343d88ec1d41\",\"_type\":\"span\",\"marks\":[\"6c2f383afed8\"],\"text\":\"Skills\"},{\"_key\":\"f5947ddf78f9\",\"_type\":\"span\",\"marks\":[],\"text\":\", folders of reusable instructions, scripts, and resources for models to improve performance on specialized tasks. Adding a SKILL.md file to these saved functions creates a structured skill that models can reference and use. Over time, this allows your agent to build a toolbox of higher-level capabilities, evolving the scaffolding that it needs to work most effectively.\"}],\"markDefs\":[{\"_key\":\"6c2f383afed8\",\"_type\":\"link\",\"href\":\"https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview\"}],\"style\":\"normal\"},{\"_key\":\"eea2250059be\",\"_type\":\"block\",\"children\":[{\"_key\":\"be3b11b6dd690\",\"_type\":\"span\",\"marks\":[],\"text\":\"Note that code execution introduces its own complexity. Running agent-generated code requires a secure execution environment with appropriate \"},{\"_key\":\"be3b11b6dd691\",\"_type\":\"span\",\"marks\":[\"da6489265843\"],\"text\":\"sandboxing\"},{\"_key\":\"be3b11b6dd692\",\"_type\":\"span\",\"marks\":[],\"text\":\", resource limits, and monitoring. These infrastructure requirements add operational overhead and security considerations that direct tool calls avoid. The benefits of code execution—reduced token costs, lower latency, and improved tool composition—should be weighed against these implementation costs.\"}],\"markDefs\":[{\"_key\":\"da6489265843\",\"_type\":\"link\",\"href\":\"https://www.anthropic.com/engineering/claude-code-sandboxing\"}],\"style\":\"normal\"},{\"_key\":\"f7397735d90d\",\"_type\":\"block\",\"children\":[{\"_key\":\"2ead52504abd0\",\"_type\":\"span\",\"marks\":[\"strong\"],\"text\":\"Summary\"}],\"markDefs\":[],\"style\":\"h2\"},{\"_key\":\"b1cb8362459d\",\"_type\":\"block\",\"children\":[{\"_key\":\"c2d48e7944f80\",\"_type\":\"span\",\"marks\":[],\"text\":\"MCP provides a foundational protocol for agents to connect to many tools and systems. However, once too many servers are connected, tool definitions and results can consume excessive tokens, reducing agent efficiency.\"}],\"markDefs\":[],\"style\":\"normal\"},{\"_key\":\"1084809b493f\",\"_type\":\"block\",\"children\":[{\"_key\":\"1fd9c7639c4f0\",\"_type\":\"span\",\"marks\":[],\"text\":\"Although many of the problems here feel novel—context management, tool composition, state persistence—they have known solutions from software engineering. Code execution applies these established patterns to agents, letting them use familiar programming constructs to interact with MCP servers more efficiently. If you implement this approach, we encourage you to share your findings with the \"},{\"_key\":\"1fd9c7639c4f1\",\"_type\":\"span\",\"marks\":[\"0f4c9450f35f\"],\"text\":\"MCP community\"},{\"_key\":\"1fd9c7639c4f2\",\"_type\":\"span\",\"marks\":[],\"text\":\".\"}],\"markDefs\":[{\"_key\":\"0f4c9450f35f\",\"_type\":\"link\",\"href\":\"https://modelcontextprotocol.io/community/communication\"}],\"style\":\"normal\"},{\"_key\":\"d08d17f1a0b6\",\"_type\":\"block\",\"children\":[{\"_key\":\"3a6defea682e\",\"_type\":\"span\",\"marks\":[],\"text\":\"Acknowledgments \"}],\"markDefs\":[],\"style\":\"h3\"},{\"_key\":\"d7d438f81aad\",\"_type\":\"block\",\"children\":[{\"_key\":\"e22745a7c1d30\",\"_type\":\"span\",\"marks\":[\"em\"],\"text\":\"This article was written by Adam Jones and Conor Kelly. Thanks to Jeremy Fox, Jerome Swannack, Stuart Ritchie, Molly Vorwerck, Matt Samuels, and Maggie Vo for feedback on drafts of this post.\"}],\"markDefs\":[],\"style\":\"normal\"}],\"cardImage\":{\"_type\":\"image\",\"asset\":{\"_ref\":\"image-42f40f6fae9ec2d7cf2e5a98908a16d0216b91be-1000x1000-svg\",\"_type\":\"reference\"},\"height\":1000,\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/42f40f6fae9ec2d7cf2e5a98908a16d0216b91be-1000x1000.svg\",\"width\":1000},\"hero\":{\"_type\":\"image\",\"asset\":{\"_ref\":\"image-42f40f6fae9ec2d7cf2e5a98908a16d0216b91be-1000x1000-svg\",\"_type\":\"reference\"},\"caption\":null,\"height\":1000,\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/42f40f6fae9ec2d7cf2e5a98908a16d0216b91be-1000x1000.svg\",\"width\":1000},\"meta\":{\"robotsIndexable\":true,\"seoDescription\":\"Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%.\",\"seoTitle\":\"Code execution with MCP: building more efficient AI agents\",\"socialImage\":{\"_type\":\"image\",\"asset\":{\"_createdAt\":\"2025-10-30T17:54:48Z\",\"_id\":\"image-8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260-png\",\"_rev\":\"hRMcU4dW73rQ24hVhUfOov\",\"_type\":\"sanity.imageAsset\",\"_updatedAt\":\"2025-10-30T17:54:48Z\",\"assetId\":\"8071ace7b1158ab6d3f8fa04679cef31234425ab\",\"extension\":\"png\",\"metadata\":{\"_type\":\"sanity.imageMetadata\",\"blurHash\":\"MCR3N8xu~pxu9F%LfPt7j]WB?aayD%of%L\",\"dimensions\":{\"_type\":\"sanity.imageDimensions\",\"aspectRatio\":1.9047619047619047,\"height\":1260,\"width\":2400},\"hasAlpha\":true,\"isOpaque\":true,\"lqip\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR4nK2S207CUBRE+f9/MDFRY+KDQYWKhXIpJYQW5FKgKFja0hZKKfUPlvE8K3gSH+ZpJysze6bweYz5TxVOHQ/7gDj8YBe7pIlPsvXYJz7HQygP3O88ZnafhvZMu1VlOOgysAzsiUkcrsizSA7orx20apnrqwtuby55LN4JNesVPHcuB8yziDB4x+rp1NQS9ZoinKovT3QMDc915B1maUgYLHFmQ5zZK/bYwmhrmD2dwFvIAw/pt0uf6WREx2iIqOXSPXpTFUCpUvJjTLLb4K7W9K0+SumBilJEb6nYY5Nku5ZvOUsjttEGd7lgPDKZTwcE3pto/7e4Z3eYZ7HYXJZuxE9Pgf4E/OkV54BfIIEnCU9Fb0cAAAAASUVORK5CYII=\",\"palette\":{\"_type\":\"sanity.imagePalette\",\"darkMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#44443d\",\"foreground\":\"#fff\",\"population\":0.09,\"title\":\"#fff\"},\"darkVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#724212\",\"foreground\":\"#fff\",\"population\":0,\"title\":\"#fff\"},\"dominant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#c7c4cd\",\"foreground\":\"#000\",\"population\":1.3,\"title\":\"#fff\"},\"lightMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#c7c4cd\",\"foreground\":\"#000\",\"population\":1.3,\"title\":\"#fff\"},\"lightVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#fcf4ec\",\"foreground\":\"#000\",\"population\":0.09,\"title\":\"#000\"},\"muted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#7c746c\",\"foreground\":\"#fff\",\"population\":0.01,\"title\":\"#fff\"},\"vibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#dc7f22\",\"foreground\":\"#fff\",\"population\":0,\"title\":\"#fff\"}}},\"mimeType\":\"image/png\",\"originalFilename\":\"eng-blog-social.png\",\"path\":\"images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png\",\"sha1hash\":\"8071ace7b1158ab6d3f8fa04679cef31234425ab\",\"size\":57013,\"uploadId\":\"hshWs6QXXktaxlbSDoXnvx967CZPmt1P\",\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png\"},\"description\":\"Image for MCP and code execution blog post.\"}},\"publishedOn\":\"2025-11-04\",\"showSidebar\":false,\"slug\":{\"_type\":\"slug\",\"current\":\"code-execution-with-mcp\"},\"spotIllustration\":{\"_type\":\"image\",\"asset\":{\"_ref\":\"image-848e961961a97ada3a7edb2d1d17378792c3288d-500x500-svg\",\"_type\":\"reference\"},\"height\":500,\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/848e961961a97ada3a7edb2d1d17378792c3288d-500x500.svg\",\"width\":500},\"subjects\":[{\"_key\":\"open-source\",\"_type\":\"tag\",\"label\":\"Open Source\",\"value\":\"open-source\"}],\"summary\":\"Direct tool calls consume context for each definition and result. Agents scale better by writing code to call tools instead. Here's how it works with MCP.\",\"title\":\"Code execution with MCP: Building more efficient agents\"},\"siteSettings\":{\"_createdAt\":\"2023-11-03T16:49:36Z\",\"_id\":\"13c6e1a1-6f38-400c-ae18-89d73b6ba991\",\"_rev\":\"7EycaOswzF19RNL4QGKeTt\",\"_system\":{\"base\":{\"id\":\"13c6e1a1-6f38-400c-ae18-89d73b6ba991\",\"rev\":\"bwKPjmaYrsWzvRbqu3Kvp6\"}},\"_type\":\"siteSettings\",\"_updatedAt\":\"2025-11-05T15:41:18Z\",\"announcement\":null,\"claudeCta\":{\"desktopCtas\":null,\"mobileCtas\":[{\"title\":\"Log in to Claude\",\"url\":\"https://claude.ai/login\"},{\"title\":\"Download app\",\"url\":\"https://claude.ai/download\"}],\"sections\":[{\"category\":\"Products\",\"links\":[{\"title\":\"Claude\",\"url\":\"https://claude.com/product/overview\"},{\"title\":\"Claude Code\",\"url\":\"https://claude.com/product/claude-code\"},{\"title\":\"Claude Developer Platform\",\"url\":\"https://claude.com/platform/api\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing\"},{\"title\":\"Contact sales\",\"url\":\"https://claude.com/contact-sales\"}]},{\"category\":\"Models\",\"links\":[{\"title\":\"Opus\",\"url\":\"/claude/opus\"},{\"title\":\"Sonnet\",\"url\":\"/claude/sonnet\"},{\"title\":\"Haiku\",\"url\":\"/claude/haiku\"}]},{\"category\":\"Log in\",\"links\":[{\"title\":\"Claude.ai\",\"url\":\"https://claude.ai\"},{\"title\":\"Claude Console\",\"url\":\"https://console.claude.com\"}]}],\"title\":\"Try Claude\",\"url\":\"https://claude.ai/\"},\"copyright\":\"© 2025 Anthropic PBC\",\"footerNavigation\":[{\"_key\":\"716b96b62292\",\"links\":[{\"title\":\"Claude\",\"url\":\"https://claude.com/product/overview\"},{\"title\":\"Claude Code\",\"url\":\"https://claude.com/product/claude-code\"},{\"title\":\"Claude and Slack\",\"url\":\"https://claude.com/claude-and-slack\"},{\"title\":\"Claude in Excel\",\"url\":\"https://claude.com/claude-for-excel\"},{\"title\":\"Max plan\",\"url\":\"https://claude.com/pricing/max\"},{\"title\":\"Team plan\",\"url\":\"https://claude.com/pricing/team\"},{\"title\":\"Enterprise plan\",\"url\":\"https://claude.com/pricing/enterprise\"},{\"title\":\"Download app\",\"url\":\"https://claude.ai/download\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing\"},{\"title\":\"Log in to Claude\",\"url\":\"https://claude.ai/\"}],\"title\":\"Products\"},{\"_key\":\"0229138ff25d\",\"links\":[{\"title\":\"Opus\",\"url\":\"https://www.anthropic.com/claude/opus\"},{\"title\":\"Sonnet\",\"url\":\"https://www.anthropic.com/claude/sonnet\"},{\"title\":\"Haiku\",\"url\":\"https://www.anthropic.com/claude/haiku\"}],\"title\":\"Models\"},{\"_key\":\"df2df9219e3abce95d6d83387e2d9bd6\",\"links\":[{\"title\":\"AI agents\",\"url\":\"https://claude.com/solutions/agents\"},{\"title\":\"Code modernization\",\"url\":\"https://claude.com/solutions/code-modernization\"},{\"title\":\"Coding\",\"url\":\"https://claude.com/solutions/coding\"},{\"title\":\"Customer support\",\"url\":\"https://claude.com/solutions/customer-support\"},{\"title\":\"Education\",\"url\":\"https://claude.com/solutions/education\"},{\"title\":\"Financial services\",\"url\":\"https://claude.com/solutions/financial-services\"},{\"title\":\"Government\",\"url\":\"https://claude.com/solutions/government\"},{\"title\":\"Life sciences\",\"url\":\"https://claude.com/solutions/life-sciences\"}],\"title\":\"Solutions\"},{\"_key\":\"f286ca01fc7aaabd131f347b711a971b\",\"links\":[{\"title\":\"Overview\",\"url\":\"https://claude.com/platform/api\"},{\"title\":\"Developer docs\",\"url\":\"https://docs.claude.com/en/home\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing#api\"},{\"title\":\"Amazon Bedrock\",\"url\":\"https://claude.com/partners/amazon-bedrock\"},{\"title\":\"Google Cloud’s Vertex AI\",\"url\":\"https://claude.com/partners/google-cloud-vertex-ai\"},{\"title\":\"Console login\",\"url\":\"http://console.anthropic.com/\"}],\"title\":\"Claude Developer Platform\"},{\"_key\":\"4b255e67f68c270e0072c7564e084e24\",\"links\":[{\"title\":\"Blog\",\"url\":\"https://claude.com/blog\"},{\"title\":\"Courses\",\"url\":\"/learn\"},{\"title\":\"Connectors\",\"url\":\"https://claude.com/partners/mcp\"},{\"title\":\"Customer stories\",\"url\":\"https://claude.com/customers\"},{\"title\":\"Engineering at Anthropic\",\"url\":\"/engineering\"},{\"title\":\"Events\",\"url\":\"/events\"},{\"title\":\"Powered by Claude\",\"url\":\"https://claude.com/partners/powered-by-claude\"},{\"title\":\"Service partners\",\"url\":\"https://claude.com/partners/services\"},{\"title\":\"Startups program\",\"url\":\"https://claude.com/programs/startups\"}],\"title\":\"Learn\"},{\"_key\":\"4f2729951e15b0b870897e0444f5f3e1\",\"links\":[{\"title\":\"Anthropic\",\"url\":\"/company\"},{\"title\":\"Careers\",\"url\":\"/careers\"},{\"title\":\"Economic Futures\",\"url\":\"/economic-index\"},{\"title\":\"Research\",\"url\":\"/research\"},{\"title\":\"News\",\"url\":\"/news\"},{\"title\":\"Responsible Scaling Policy\",\"url\":\"https://www.anthropic.com/news/announcing-our-updated-responsible-scaling-policy\"},{\"title\":\"Security and compliance\",\"url\":\"https://trust.anthropic.com/\"},{\"title\":\"Transparency\",\"url\":\"/transparency\"}],\"title\":\"Company\"},{\"_key\":\"a886dd1838335844d635f2857b25d66a\",\"links\":[{\"title\":\"Availability\",\"url\":\"https://www.anthropic.com/supported-countries\"},{\"title\":\"Status\",\"url\":\"https://status.anthropic.com/\"},{\"title\":\"Support center\",\"url\":\"https://support.claude.com/en/\"}],\"title\":\"Help and security\"},{\"_key\":\"3c3b033c11fa832a35d43b87d55a5364\",\"links\":[{\"title\":\"Privacy choices\",\"url\":\"#\"},{\"title\":\"Privacy policy\",\"url\":\"https://www.anthropic.com/legal/privacy\"},{\"title\":\"Responsible disclosure policy\",\"url\":\"https://www.anthropic.com/responsible-disclosure-policy\"},{\"title\":\"Terms of service: Commercial\",\"url\":\"https://www.anthropic.com/legal/commercial-terms\"},{\"title\":\"Terms of service: Consumer\",\"url\":\"https://www.anthropic.com/legal/consumer-terms\"},{\"title\":\"Usage policy\",\"url\":\"https://www.anthropic.com/legal/aup\"}],\"title\":\"Terms and policies\"}],\"headerNavigation\":[{\"_key\":\"a340f9d4b859\",\"category\":\"Research\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/research\"},{\"_key\":\"a483c7dfd38a\",\"category\":\"Economic Futures\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/economic-futures\"},{\"_key\":\"82c471bd311d\",\"category\":\"Commitments\",\"displayType\":\"sections\",\"sections\":[{\"_key\":\"675871636e4d\",\"links\":[{\"title\":\" Transparency\",\"url\":\"/transparency\"},{\"title\":\"Responsible Scaling Policy\",\"url\":\"/news/announcing-our-updated-responsible-scaling-policy\"}],\"title\":\"Initiatives\"},{\"_key\":\"16af50a6e2dd\",\"links\":[{\"title\":\"Security and compliance\",\"url\":\"https://trust.anthropic.com/\"}],\"title\":\"Trust center\"}]},{\"_key\":\"861a11ed9931\",\"category\":\"Learn\",\"displayType\":\"sections\",\"sections\":[{\"_key\":\"9f9f720a8793\",\"links\":[{\"title\":\"Anthropic Academy\",\"url\":\"/learn\"},{\"title\":\"Engineering at Anthropic\",\"url\":\"/engineering\"},{\"title\":\"Developer docs\",\"url\":\"https://docs.claude.com\"}],\"title\":\"Learn\"},{\"_key\":\"6bd061c46b10\",\"links\":[{\"title\":\"About\",\"url\":\"/company\"},{\"title\":\"Careers\",\"url\":\"/careers\"},{\"title\":\"Events\",\"url\":\"/events\"}],\"title\":\"Company\"}]},{\"_key\":\"22e8d8d2923d\",\"category\":\"News\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/news\"}],\"internalName\":\"anthropic.com Site Settings\",\"linkedInUsername\":\"anthropicresearch\",\"meta\":{\"_createdAt\":\"2023-11-20T21:56:31Z\",\"_id\":\"0f6290ad-6d21-407d-8deb-ce02815d1383\",\"_rev\":\"NyW74GU9ZzyWgAYa8qUSlF\",\"_type\":\"metadata\",\"_updatedAt\":\"2023-11-20T23:54:09Z\",\"robotsIndexable\":true,\"seoDescription\":\"Anthropic is an AI safety and research company that's working to build reliable, interpretable, and steerable AI systems.\",\"seoTitle\":\"Anthropic\",\"socialImage\":{\"_type\":\"image\",\"asset\":{\"_createdAt\":\"2025-05-23T14:14:18Z\",\"_id\":\"image-c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260-jpg\",\"_rev\":\"v1N2wBpLqoO2Q3HXueYiJi\",\"_type\":\"sanity.imageAsset\",\"_updatedAt\":\"2025-05-23T14:14:18Z\",\"assetId\":\"c07f638082c569e8ce1e89ae95ee6f332a98ec08\",\"extension\":\"jpg\",\"metadata\":{\"_type\":\"sanity.imageMetadata\",\"blurHash\":\"MASPU,%M?b%Ms:-;j[j[j[fQ~qj[9FayWB\",\"dimensions\":{\"_type\":\"sanity.imageDimensions\",\"aspectRatio\":1.9047619047619047,\"height\":1260,\"width\":2400},\"hasAlpha\":false,\"isOpaque\":true,\"lqip\":\"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAQFCP/EACAQAAEEAgEFAAAAAAAAAAAAAAABAgMEBRETEhQhIjH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDS96axCjO2r8yqvn21oiR3ci6TT8d0t395ELUGVAAB/9k=\",\"palette\":{\"_type\":\"sanity.imagePalette\",\"darkMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#444440\",\"foreground\":\"#fff\",\"population\":0.05,\"title\":\"#fff\"},\"darkVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#68681c\",\"foreground\":\"#fff\",\"population\":0,\"title\":\"#fff\"},\"dominant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#fcfcf4\",\"foreground\":\"#000\",\"population\":90.85,\"title\":\"#000\"},\"lightMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#bcbcb4\",\"foreground\":\"#000\",\"population\":0.03,\"title\":\"#fff\"},\"lightVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#fcfcf4\",\"foreground\":\"#000\",\"population\":90.85,\"title\":\"#000\"},\"muted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#7c7c74\",\"foreground\":\"#fff\",\"population\":0.02,\"title\":\"#fff\"},\"vibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#c8c836\",\"foreground\":\"#000\",\"population\":0,\"title\":\"#fff\"}}},\"mimeType\":\"image/jpeg\",\"originalFilename\":\"Anthropic-OG-image.jpg\",\"path\":\"images/4zrzovbb/website/c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260.jpg\",\"sha1hash\":\"c07f638082c569e8ce1e89ae95ee6f332a98ec08\",\"size\":132598,\"uploadId\":\"pxmJEaCvYm0cHoZTfnCcZYXxrWKBhHf0\",\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260.jpg\"},\"description\":\"Anthropic logo\"}},\"siteName\":\"Anthropic\",\"sitemapUrls\":[\"/\",\"/careers\",\"/company\",\"/events\",\"/events/aws-summit-dc\",\"/events/aws-summit-nyc\",\"/events/aws-summit-london\",\"/events/aws-summit-tokyo\",\"/events/claude-for-finance\",\"/events/google-cloud-next-2025\",\"/events/paris-builder-summit\",\"/events/seoul-builder-summit\",\"/learn\",\"/supported-countries\",\"/unsubscribe\"],\"twitterUsername\":\"AnthropicAI\",\"youtubeUsername\":\"anthropic-ai\"}}]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"24:[\"$\",\"$L2a\",null,{\"siteSettings\":{\"_createdAt\":\"2023-11-03T16:49:36Z\",\"_id\":\"13c6e1a1-6f38-400c-ae18-89d73b6ba991\",\"_rev\":\"7EycaOswzF19RNL4QGKeTt\",\"_system\":{\"base\":{\"id\":\"13c6e1a1-6f38-400c-ae18-89d73b6ba991\",\"rev\":\"bwKPjmaYrsWzvRbqu3Kvp6\"}},\"_type\":\"siteSettings\",\"_updatedAt\":\"2025-11-05T15:41:18Z\",\"announcement\":null,\"claudeCta\":{\"desktopCtas\":null,\"mobileCtas\":[{\"title\":\"Log in to Claude\",\"url\":\"https://claude.ai/login\"},{\"title\":\"Download app\",\"url\":\"https://claude.ai/download\"}],\"sections\":[{\"category\":\"Products\",\"links\":[{\"title\":\"Claude\",\"url\":\"https://claude.com/product/overview\"},{\"title\":\"Claude Code\",\"url\":\"https://claude.com/product/claude-code\"},{\"title\":\"Claude Developer Platform\",\"url\":\"https://claude.com/platform/api\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing\"},{\"title\":\"Contact sales\",\"url\":\"https://claude.com/contact-sales\"}]},{\"category\":\"Models\",\"links\":[{\"title\":\"Opus\",\"url\":\"/claude/opus\"},{\"title\":\"Sonnet\",\"url\":\"/claude/sonnet\"},{\"title\":\"Haiku\",\"url\":\"/claude/haiku\"}]},{\"category\":\"Log in\",\"links\":[{\"title\":\"Claude.ai\",\"url\":\"https://claude.ai\"},{\"title\":\"Claude Console\",\"url\":\"https://console.claude.com\"}]}],\"title\":\"Try Claude\",\"url\":\"https://claude.ai/\"},\"copyright\":\"© 2025 Anthropic PBC\",\"footerNavigation\":[{\"_key\":\"716b96b62292\",\"links\":[{\"title\":\"Claude\",\"url\":\"https://claude.com/product/overview\"},{\"title\":\"Claude Code\",\"url\":\"https://claude.com/product/claude-code\"},{\"title\":\"Claude and Slack\",\"url\":\"https://claude.com/claude-and-slack\"},{\"title\":\"Claude in Excel\",\"url\":\"https://claude.com/claude-for-excel\"},{\"title\":\"Max plan\",\"url\":\"https://claude.com/pricing/max\"},{\"title\":\"Team plan\",\"url\":\"https://claude.com/pricing/team\"},{\"title\":\"Enterprise plan\",\"url\":\"https://claude.com/pricing/enterprise\"},{\"title\":\"Download app\",\"url\":\"https://claude.ai/download\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing\"},{\"title\":\"Log in to Claude\",\"url\":\"https://claude.ai/\"}],\"title\":\"Products\"},{\"_key\":\"0229138ff25d\",\"links\":[{\"title\":\"Opus\",\"url\":\"https://www.anthropic.com/claude/opus\"},{\"title\":\"Sonnet\",\"url\":\"https://www.anthropic.com/claude/sonnet\"},{\"title\":\"Haiku\",\"url\":\"https://www.anthropic.com/claude/haiku\"}],\"title\":\"Models\"},{\"_key\":\"df2df9219e3abce95d6d83387e2d9bd6\",\"links\":[{\"title\":\"AI agents\",\"url\":\"https://claude.com/solutions/agents\"},{\"title\":\"Code modernization\",\"url\":\"https://claude.com/solutions/code-modernization\"},{\"title\":\"Coding\",\"url\":\"https://claude.com/solutions/coding\"},{\"title\":\"Customer support\",\"url\":\"https://claude.com/solutions/customer-support\"},{\"title\":\"Education\",\"url\":\"https://claude.com/solutions/education\"},{\"title\":\"Financial services\",\"url\":\"https://claude.com/solutions/financial-services\"},{\"title\":\"Government\",\"url\":\"https://claude.com/solutions/government\"},{\"title\":\"Life sciences\",\"url\":\"https://claude.com/solutions/life-sciences\"}],\"title\":\"Solutions\"},{\"_key\":\"f286ca01fc7aaabd131f347b711a971b\",\"links\":[{\"title\":\"Overview\",\"url\":\"https://claude.com/platform/api\"},{\"title\":\"Developer docs\",\"url\":\"https://docs.claude.com/en/home\"},{\"title\":\"Pricing\",\"url\":\"https://claude.com/pricing#api\"},{\"title\":\"Amazon Bedrock\",\"url\":\"https://claude.com/partners/amazon-bedrock\"},{\"title\":\"Google Cloud’s Vertex AI\",\"url\":\"https://claude.com/partners/google-cloud-vertex-ai\"},{\"title\":\"Console login\",\"url\":\"http://console.anthropic.com/\"}],\"title\":\"Claude Developer Platform\"},{\"_key\":\"4b255e67f68c270e0072c7564e084e24\",\"links\":[{\"title\":\"Blog\",\"url\":\"https://claude.com/blog\"},{\"title\":\"Courses\",\"url\":\"/learn\"},{\"title\":\"Connectors\",\"url\":\"https://claude.com/partners/mcp\"},{\"title\":\"Customer stories\",\"url\":\"https://claude.com/customers\"},{\"title\":\"Engineering at Anthropic\",\"url\":\"/engineering\"},{\"title\":\"Events\",\"url\":\"/events\"},{\"title\":\"Powered by Claude\",\"url\":\"https://claude.com/partners/powered-by-claude\"},{\"title\":\"Service partners\",\"url\":\"https://claude.com/partners/services\"},{\"title\":\"Startups program\",\"url\":\"https://claude.com/programs/startups\"}],\"title\":\"Learn\"},{\"_key\":\"4f2729951e15b0b870897e0444f5f3e1\",\"links\":[{\"title\":\"Anthropic\",\"url\":\"/company\"},{\"title\":\"Careers\",\"url\":\"/careers\"},{\"title\":\"Economic Futures\",\"url\":\"/economic-index\"},{\"title\":\"Research\",\"url\":\"/research\"},{\"title\":\"News\",\"url\":\"/news\"},{\"title\":\"Responsible Scaling Policy\",\"url\":\"https://www.anthropic.com/news/announcing-our-updated-responsible-scaling-policy\"},{\"title\":\"Security and compliance\",\"url\":\"https://trust.anthropic.com/\"},{\"title\":\"Transparency\",\"url\":\"/transparency\"}],\"title\":\"Company\"},{\"_key\":\"a886dd1838335844d635f2857b25d66a\",\"links\":[{\"title\":\"Availability\",\"url\":\"https://www.anthropic.com/supported-countries\"},{\"title\":\"Status\",\"url\":\"https://status.anthropic.com/\"},{\"title\":\"Support center\",\"url\":\"https://support.claude.com/en/\"}],\"title\":\"Help and security\"},{\"_key\":\"3c3b033c11fa832a35d43b87d55a5364\",\"links\":[{\"title\":\"Privacy choices\",\"url\":\"#\"},{\"title\":\"Privacy policy\",\"url\":\"https://www.anthropic.com/legal/privacy\"},{\"title\":\"Responsible disclosure policy\",\"url\":\"https://www.anthropic.com/responsible-disclosure-policy\"},{\"title\":\"Terms of service: Commercial\",\"url\":\"https://www.anthropic.com/legal/commercial-terms\"},{\"title\":\"Terms of service: Consumer\",\"url\":\"https://www.anthropic.com/legal/consumer-terms\"},{\"title\":\"Usage policy\",\"url\":\"https://www.anthropic.com/legal/aup\"}],\"title\":\"Terms and policies\"}],\"headerNavigation\":[{\"_key\":\"a340f9d4b859\",\"category\":\"Research\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/research\"},{\"_key\":\"a483c7dfd38a\",\"category\":\"Economic Futures\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/economic-futures\"},{\"_key\":\"82c471bd311d\",\"category\":\"Commitments\",\"displayType\":\"sections\",\"sections\":[{\"_key\":\"675871636e4d\",\"links\":[{\"title\":\" Transparency\",\"url\":\"/transparency\"},{\"title\":\"Responsible Scaling Policy\",\"url\":\"/news/announcing-our-updated-responsible-scaling-policy\"}],\"title\":\"Initiatives\"},{\"_key\":\"16af50a6e2dd\",\"links\":[{\"title\":\"Security and compliance\",\"url\":\"https://trust.anthropic.com/\"}],\"title\":\"Trust center\"}]},{\"_key\":\"861a11ed9931\",\"category\":\"Learn\",\"displayType\":\"sections\",\"sections\":[{\"_key\":\"9f9f720a8793\",\"links\":[{\"title\":\"Anthropic Academy\",\"url\":\"/learn\"},{\"title\":\"Engineering at Anthropic\",\"url\":\"/engineering\"},{\"title\":\"Developer docs\",\"url\":\"https://docs.claude.com\"}],\"title\":\"Learn\"},{\"_key\":\"6bd061c46b10\",\"links\":[{\"title\":\"About\",\"url\":\"/company\"},{\"title\":\"Careers\",\"url\":\"/careers\"},{\"title\":\"Events\",\"url\":\"/events\"}],\"title\":\"Company\"}]},{\"_key\":\"22e8d8d2923d\",\"category\":\"News\",\"displayType\":\"singleLink\",\"sections\":null,\"url\":\"/news\"}],\"internalName\":\"anthropic.com Site Settings\",\"linkedInUsername\":\"anthropicresearch\",\"meta\":{\"_createdAt\":\"2023-11-20T21:56:31Z\",\"_id\":\"0f6290ad-6d21-407d-8deb-ce02815d1383\",\"_rev\":\"NyW74GU9ZzyWgAYa8qUSlF\",\"_type\":\"metadata\",\"_updatedAt\":\"2023-11-20T23:54:09Z\",\"robotsIndexable\":true,\"seoDescription\":\"Anthropic is an AI safety and research company that's working to build reliable, interpretable, and steerable AI systems.\",\"seoTitle\":\"Anthropic\",\"socialImage\":{\"_type\":\"image\",\"asset\":{\"_createdAt\":\"2025-05-23T14:14:18Z\",\"_id\":\"image-c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260-jpg\",\"_rev\":\"v1N2wBpLqoO2Q3HXueYiJi\",\"_type\":\"sanity.imageAsset\",\"_updatedAt\":\"2025-05-23T14:14:18Z\",\"assetId\":\"c07f638082c569e8ce1e89ae95ee6f332a98ec08\",\"extension\":\"jpg\",\"metadata\":{\"_type\":\"sanity.imageMetadata\",\"blurHash\":\"MASPU,%M?b%Ms:-;j[j[j[fQ~qj[9FayWB\",\"dimensions\":{\"_type\":\"sanity.imageDimensions\",\"aspectRatio\":1.9047619047619047,\"height\":1260,\"width\":2400},\"hasAlpha\":false,\"isOpaque\":true,\"lqip\":\"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAQFCP/EACAQAAEEAgEFAAAAAAAAAAAAAAABAgMEBRETEhQhIjH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDS96axCjO2r8yqvn21oiR3ci6TT8d0t395ELUGVAAB/9k=\",\"palette\":{\"_type\":\"sanity.imagePalette\",\"darkMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#444440\",\"foreground\":\"#fff\",\"population\":0.05,\"title\":\"#fff\"},\"darkVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#68681c\",\"foreground\":\"#fff\",\"population\":0,\"title\":\"#fff\"},\"dominant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#fcfcf4\",\"foreground\":\"#000\",\"population\":90.85,\"title\":\"#000\"},\"lightMuted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#bcbcb4\",\"foreground\":\"#000\",\"population\":0.03,\"title\":\"#fff\"},\"lightVibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#fcfcf4\",\"foreground\":\"#000\",\"population\":90.85,\"title\":\"#000\"},\"muted\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#7c7c74\",\"foreground\":\"#fff\",\"population\":0.02,\"title\":\"#fff\"},\"vibrant\":{\"_type\":\"sanity.imagePaletteSwatch\",\"background\":\"#c8c836\",\"foreground\":\"#000\",\"population\":0,\"title\":\"#fff\"}}},\"mimeType\":\"image/jpeg\",\"originalFilename\":\"Anthropic-OG-image.jpg\",\"path\":\"images/4zrzovbb/website/c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260.jpg\",\"sha1hash\":\"c07f638082c569e8ce1e89ae95ee6f332a98ec08\",\"size\":132598,\"uploadId\":\"pxmJEaCvYm0cHoZTfnCcZYXxrWKBhHf0\",\"url\":\"https://cdn.sanity.io/images/4zrzovbb/website/c07f638082c569e8ce1e89ae95ee6f332a98ec08-2400x1260.jpg\"},\"description\":\"Anthropic logo\"}},\"siteName\":\"Anthropic\",\"sitemapUrls\":[\"/\",\"/careers\",\"/company\",\"/events\",\"/events/aws-summit-dc\",\"/events/aws-summit-nyc\",\"/events/aws-summit-london\",\"/events/aws-summit-tokyo\",\"/events/claude-for-finance\",\"/events/google-cloud-next-2025\",\"/events/paris-builder-summit\",\"/events/seoul-builder-summit\",\"/learn\",\"/supported-countries\",\"/unsubscribe\"],\"twitterUsername\":\"AnthropicAI\",\"youtubeUsername\":\"anthropic-ai\",\"hideFooter\":true},\"page\":{\"_type\":\"page\",\"_id\":\"not-found\",\"_rev\":\"\",\"_createdAt\":\"\",\"_updatedAt\":\"\",\"title\":\"Not Found\",\"slug\":{\"_type\":\"slug\",\"current\":\"not-found\"},\"meta\":{},\"sections\":[]},\"children\":[\"$\",\"$L2b\",null,{}]}]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"26:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"name\":\"theme-color\",\"content\":\"#141413\"}],[\"$\",\"meta\",\"2\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"3\",{\"children\":\"Code execution with MCP: building more efficient AI agents \\\\ Anthropic\"}],[\"$\",\"meta\",\"4\",{\"name\":\"description\",\"content\":\"Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%.\"}],[\"$\",\"meta\",\"5\",{\"name\":\"msapplication-TileColor\",\"content\":\"141413\"}],[\"$\",\"meta\",\"6\",{\"name\":\"msapplication-config\",\"content\":\"/browserconfig.xml\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:title\",\"content\":\"Code execution with MCP: building more efficient AI agents\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:description\",\"content\":\"Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%.\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://cdn.sanity.io/images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:alt\",\"content\":\"Image for MCP and code execution blog post.\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:site\",\"content\":\"@AnthropicAI\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:creator\",\"content\":\"@AnthropicAI\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:title\",\"content\":\"Code execution with MCP: building more efficient AI agents\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:description\",\"content\":\"Learn how code execution with the Model Context Protocol enables agents to handle more tools while using fewer tokens, reducing context overhead by up to 98.7%.\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:image\",\"content\":\"https://cdn.sanity.io/images/4zrzovbb/website/8071ace7b1158ab6d3f8fa04679cef31234425ab-2400x1260.png\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:image:alt\",\"content\":\"Image for MCP and code execution blog post.\"}],[\"$\",\"link\",\"19\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"20\",{\"rel\":\"icon\",\"href\":\"/images/icons/favicon-32x32.png\"}],[\"$\",\"link\",\"21\",{\"rel\":\"apple-touch-icon\",\"href\":\"/images/icons/apple-touch-icon.png\"}],[\"$\",\"link\",\"22\",{\"rel\":\"apple-touch-icon\",\"href\":\"/images/icons/apple-touch-icon.png\",\"sizes\":\"180x180\"}],[\"$\",\"link\",\"23\",{\"rel\":\"mask-icon\",\"href\":\"/images/icons/safari-pinned-tab.svg\",\"color\":\"141413\"}],[\"$\",\"meta\",\"24\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script nonce="MTIzOTU4Y2QtMmVlOS00MmIxLWEzZDItZjRiY2RjOGZmMWFm">self.__next_f.push([1,"1d:null\n"])</script></body></html>